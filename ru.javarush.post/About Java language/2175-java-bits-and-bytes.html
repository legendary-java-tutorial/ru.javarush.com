Java: bits and bytes
<p>----------------------------------------</p>
Если люди считают в десятичной системе счисления, то компьютеры — в двоичной. А программист должен понимать,как говорить и с людьми, и с компьютерами. Данный обзор должен помочь в этом деле. Порой за очевидными вещами кроется целый мир ...
<p>----------------------------------------</p>
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="6ae956a5-f56b-4119-b013-a084d3cbde2f" data-max-width="256" alt="Java: bits and bytes - 1" src="https://cdn.javarush.com/images/article/6ae956a5-f56b-4119-b013-a084d3cbde2f/1024.jpeg"></div></div><h2>Вступление</h2>Если люди считают в десятичной системе счисления, то компьютеры — в двоичной. А программист должен понимать,как говорить и с людьми, и с компьютерами. Данный обзор должен помочь в этом деле. Порой за очевидными вещами кроется целый мир. Предлагаю об этом мире поговорить.

Например, в неделе 7 дней. А теперь, ответим на вопрос: Что такое число "7"? )

Во-первых, это целое (integer) положительное (positive) натуральное (natural) число. А ещё это десятичное число (decimal number).

<strong>Десятичное число</strong> — это число в десятичной системе счисления (Decimal System). Когда мы говорим "десятичная система счисления", это означает, что у системы счисления <strong>основание (base) равно 10</strong>. Основание показывает, сколько цифр может быть использовано в данной системе счисления для представления числа. Отсчёт ведётся от нуля. Соответственно, для представления чисел в десятичной системе счисления мы используем цифры от 0 до 9.

Это хорошо, но считать нужно не только до 9, но и дальше. Как же быть?

Например, число 10. Для записи данного числа мы используем уже целых 2 цифры. Позиция каждой цифры в десятичной системе называется десятичным разрядом (decimal place). Разряды отсчитываются справа налево:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="0c7f9e02-5b7d-4257-a3d8-fe187edf4fe4" data-max-width="313" alt="Java: bits and bytes - 2" src="https://cdn.javarush.com/images/article/0c7f9e02-5b7d-4257-a3d8-fe187edf4fe4/1024.jpeg"></div></div>Кроме того, десятичное число можно разложить следующим образом:

103 = 1*10^2 + 0*10^1 + 3*10^0
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="a6b70bfc-6224-44be-b791-657a4a2a8ac8" data-max-width="596" alt="Java: bits and bytes - 3" src="https://cdn.javarush.com/images/article/a6b70bfc-6224-44be-b791-657a4a2a8ac8/1024.jpeg"></div></div>Число ведь по сути растёт справа на лево. То есть сначала было 7, а потом стало 10. Поэтому и разряды считаются справа, начиная с нуля.

А для чего всё это? Всё потому, что мы — не компьютеры. И если мы считаем в десятичной системе (то есть, по основанию 10), компьютеры считают в двоичной системе счисления (то есть, по основанию 2). Но правила, которые действуют в этих системах счисления, одинаковы.
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="1d655bd0-b510-4d5d-bed5-2f2bf0408143" data-max-width="323" alt="Java: bits and bytes - 4" src="https://cdn.javarush.com/images/article/1d655bd0-b510-4d5d-bed5-2f2bf0408143/1024.jpeg"></div></div><h2>Двоичная система</h2>Двоичная система очень похожа на десятичную с тем лишь отличием, что ограничение здесь не 10, а 2.

Давайте сравним на примере. Как нам представить 11 в двоичной системе? Очень просто: надо лишь разделить десятичное число на основание 2, то есть посчитать 11/2 в столбик.

Пример:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="b54042ec-de73-45aa-b739-0e6280dcc539" data-max-width="502" alt="Java: bits and bytes - 5" src="https://cdn.javarush.com/images/article/b54042ec-de73-45aa-b739-0e6280dcc539/1024.jpeg"></div></div>Или вот пример с WikiHow:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="eb68c2fe-7e2f-430c-86cc-a3ba77f273d3" data-max-width="541" alt="Java: bits and bytes - 6" src="https://cdn.javarush.com/images/article/eb68c2fe-7e2f-430c-86cc-a3ba77f273d3/1024.jpeg"></div></div>Интересно, что мы можем число представить в двоичной системе так же, как и в десятичной:

111 в двоичной системе = 1*2^2 + 1*2^1 + 1*2^0 = 4 + 2 + 1
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="6f12c997-a04d-4338-ae16-2421321a89f2" data-max-width="273" alt="Java: bits and bytes - 7" src="https://cdn.javarush.com/images/article/6f12c997-a04d-4338-ae16-2421321a89f2/1024.jpeg"></div></div>Пример перевода из двоичной системы в десятичную можно увидеть в <a href="https://calculatori.ru/perevod-chisel.html" target="_blank" rel="nofollow">онлайн калькуляторе</a>.

Говоря про то, что правила работы в системах счисления одинаковы, давайте посмотрим на сложение в двоичной системе:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="32df86da-d258-4121-881d-c0416903c216" data-max-width="449" alt="Java: bits and bytes - 8" src="https://cdn.javarush.com/images/article/32df86da-d258-4121-881d-c0416903c216/1024.jpeg"></div></div>Как видно, мы точно так же переносим разряды при сложении, как и в десятичной системе. Разбор сложения можно посмотреть, например, здесь: 
<ul>
<li>"<a href="https://youtu.be/DUFMl1-n9Nc?t=105" target="_blank" rel="nofollow">Фоксфорд: Сложение, вычитание и умножение двоичных чисел</a>"</li>
<li>"<a href="https://www.youtube.com/watch?v=_64mBE0JBG4" target="_blank" rel="nofollow">Сложение, вычитание, умножение и деление в двоичной системе счисления</a>"</li>
</ul>Кстати, периодически упоминается какое-то слово "разряд". А что это такое?

<strong>Разряд</strong> — это всего лишь "структурный элемент" представления числа. То есть число 10 состоит из двух разрядов: нам надо 2 разряда, 2 места, 2 элемента, чтобы записать это число.

Нам это важно понимать потому, что <strong>в двоичной системе счисления разряд — это бит (bit)</strong>. Слово Bit произошло от английского <strong>"binary digit"</strong>, то есть двоичное число. Оно может быть или 0 или 1.

Но так же, как мы читаем с вами цифры и слова целиком, а не по буквам, компьютеры читают не по одному биту. За <strong>минимальной "кусок" обрабатываемой информации в оперативной памяти</strong> (так называемая наименьшая адресуемая единица информации) с<strong>читается последовательность из 8 бит</strong>. Так как их 8, этот называют "октет". А ещё — более известным нам словом <strong>Байт (Byte)</strong>.

Чтобы запомнить октет, можно запомнить, что слово осьминог (восемь ног) переводится на английский как octopus. То есть тут как раз тот самый "окто" в названии:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-max-width="253" alt="Java: bits and bytes - 9" src="https://cdn.javarush.com/images/article/1ad60989-0f82-4c9f-9bf8-42528aec09c4/original.jpeg"></div></div>Давайте подумаем, какое максимальное число мы можем представить в виде 8 бит?
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="68077744-04f3-4b0b-bf9e-a379bc33d49f" data-max-width="657" alt="Java: bits and bytes - 10" src="https://cdn.javarush.com/images/article/68077744-04f3-4b0b-bf9e-a379bc33d49f/1024.jpeg"></div></div>И тут возникает вопрос: а как же быть с отрицательными числами? Чтобы понять это, поговорим о том, как представлены байты в Java
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="f0272620-4b88-4e85-b3f7-343514379f88" data-max-width="261" alt="Java: bits and bytes - 11" src="https://cdn.javarush.com/images/article/f0272620-4b88-4e85-b3f7-343514379f88/1024.jpeg"></div></div><h2>Java и Byte</h2>Как же так получается, что в Java мы можем использовать отрицательные числа?

Сделано это просто. В Java байты знаковые. Крайний левый разряд/бит (его ещё называют "старший бит") сделан своего рода "маркером", отвечающим на вопрос: "Это число отрицательное?". Если ответ да, значит маркер имеет значение 1. А иначе — 0.

Давайте посмотрим на примере, как превратить число 5 в отрицательное число 5:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="4262d87e-1d13-4b5a-99c5-4046d9d24a90" data-max-width="561" alt="Java: bits and bytes - 12" src="https://cdn.javarush.com/images/article/4262d87e-1d13-4b5a-99c5-4046d9d24a90/1024.jpeg"></div></div>Руководствуясь этой картинкой можно понять, в каких пределах лежит значение типа Byte:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="06f28c0f-4169-4a50-bbee-cea13e6f1b1b" data-max-width="441" alt="Java: bits and bytes - 13" src="https://cdn.javarush.com/images/article/06f28c0f-4169-4a50-bbee-cea13e6f1b1b/1024.jpeg"></div></div>Так же видно, что:
<ul>
<li>если если прибавить единицу к 127, мы получим уже -128.</li>
<li>если вычесть единицу из -128, мы получим 127.</li>
</ul>Таким образом, Byte в Java может принимать значение от -128 до 127.

Как мы помним, байт — это октет. А максимальный разряд/старший бит имеет порядковый номер 7, так как мы считаем от нуля. В этом случае легко запомнить, что байт равен от -2 в степени 7 (нижняя граница) до 2 в стрепени 7 минус 1 (верхняя граница).

Работа с самим типом данных проста.

Используем в качестве "песочницы" для данной статьи онлайн компилятором Java "repl.it". https://repl.it/languages/java. Для примера выполним код, который переменную типа байт представит в двоичном виде в виде строки:

<pre class="lang-java line-numbers"><code>
class Main {
  public static void main(String[] args) {
    byte octet = 5;
    String bin = String.format("%8s", Integer.toBinaryString(octet)).replace(' ', '0');
    System.out.println(bin);
  }
}
</code></pre>
Работа с байтами активно используется при работе с I/O Streams. Подробнее можно прочитать в tutorial от Oracle: "<a href="https://docs.oracle.com/javase/tutorial/essential/io/streams.html" target="_blank" rel="nofollow">I/O Streams</a>".

Кроме того, в Java можно использовать особый литерал, чтобы значение указывать в виде битов:

<pre class="lang-java line-numbers"><code>
class Main {
  public static void main(String[] args) {
    byte data = 0b101; 
    System.out.println(data);
  }
}
</code></pre>
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-max-width="239" alt="Java: bits and bytes - 14" src="https://cdn.javarush.com/images/article/60dcb085-b253-499b-965a-7d02cd08e224/original.jpeg"></div></div><h2>Bit Manipulation</h2>Затрагивая байты и биты, нельзя не упомянуть о различных манипуляциях с битами.

Наверно, самая распространённая операция — это сдвиги (bitwise shift или bit-shift). А всё потому, что их результат имеет явную практическую пользу.

Какая польза? Сдвиг влево на N позиций эквивалентен умножению числа на 2N. А сдвиг вправо аналогичен такому же делению.Таким образом, 5&lt;&lt;2 == 5*Math.pow(2,2)

А чтобы понять, почему так, давайте посмотрим на этот пример подробнее:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="7c73ade9-1893-472b-ab15-8597403126b6" data-max-width="753" alt="Java: bits and bytes - 15" src="https://cdn.javarush.com/images/article/7c73ade9-1893-472b-ab15-8597403126b6/1024.jpeg"></div></div>Побитовое отрицание NOT (Unary bitwise), которое обозначается как тильда, инвертирует биты. Записывается как тильда, например ~5.

<pre class="lang-java line-numbers"><code>
public static void main(String[] args) {
	System.out.println(~5); //-6
 	System.out.println(~-5);//4
}
</code></pre>
Это лишний раз показывает, что когда Java меняет знак у числа, кроме инверсии значений битов в самом конце выполняем +1. А без этого, как мы видим, наше число 5 изменяется. И чтобы оно осталось тем же числом, что и до смены знака, надо делать +1.

Побитовый И (Bitwise AND) позволяет из двух разных чисел оставить значение 1 для бита только тогда, во всех битах стоит единица. Интересно это может быть тем, что у этого есть польза для примененеия:

<pre class="lang-java line-numbers"><code>
int x=4;
System.out.println((x&amp;1) != 1);
</code></pre>
Данный код проверяет число x на чётность. Давайте посмотрим на примере:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="3a015990-fd2e-42a2-873c-4349467a9daa" data-max-width="832" alt="Java: bits and bytes - 16" src="https://cdn.javarush.com/images/article/3a015990-fd2e-42a2-873c-4349467a9daa/1024.jpeg"></div></div>При помощи совместного использования побитового И (Bitwise AND) и побитового ИЛИ (Bitwise OR) можно использовать маски:

<pre class="lang-java line-numbers"><code>
public static void main(String[] args) {
    byte optionA=0b0100;
    byte optionB=0b0010;
    byte optionC=0b0001;
    byte value = (byte)(optionB | optionC);
    // Check for optionB
    if ((optionC &amp; value) != 0b0000) {
      System.out.println("Yes");
    } else {
      System.out.println("No");
    }
  }
</code></pre>
Подробнее см. "<a href="https://stackoverflow.com/questions/22725047/masking-options-with-bitwise-operators-in-java" target="_blank" rel="nofollow">Masking options with bitwise operators in Java</a>".

Манипуляции с битами — занятная тема, по которой пишутся отдельные обзоры, статьи и книги. И отсюда начинается длинный путь в криптографию. В рамках данного обзора стоит понимать, почему это работает и как. Подробнее про битовые операции рекомендую почитать обзор от tproger: "<a href="https://tproger.ru/translations/bitwise-operations/" target="_blank" rel="nofollow">О битовых операциях</a>".
<h2>Примитивные типы</h2>Итак, байт — это октет, то есть 8 бит. Легко запомнить, что в Java существует тоже 8 примитивных типов, так уж совпало.
Примитивным типом называется тип данных, который встроен в язык программирования, то есть доступен по умолчанию.

byte — минимальный по объёму занимаемой памяти примитивный тип данных, с которым может работать Java. Как мы ранее говорили, байт занимает 8 бит. Следовательно, старший разряд имеет номер 7. Поэтому, byte содержит значения от -2 в 7 степени до 2 в 7 степени минус 1 из результата.

Какие же ещё есть примитивные типы:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="12a0bdce-9a1d-4930-a490-3fb09d5612aa" data-max-width="687" alt="Java: bits and bytes - 17" src="https://cdn.javarush.com/images/article/12a0bdce-9a1d-4930-a490-3fb09d5612aa/1024.jpeg"></div></div>Как мы видим по таблице, типы данных по объёму занимаемых данных растут в два раза.

То есть short = 2 * byte, а int = 2 * short.

Запомнить, на самом деле, легко. То, что байт = 8 бит, запомнили. То, что меньше быть не может — тоже запомнили. В английском языке целое число называется integer. Примитивный тип от него назвали сокращением int. Есть обычное целое число — int. Есть его коротка версия short и длинная версия long. Соответственно int занимает 32 бита (4 байта). Короткая версия в 2 раза меньше -— 16 бит (2 байта), а длинная — в два раза больше, т.е. 64 бита (8 байт). Таким образом, int максимум может хранить число примерно в 2 миллиарда и сто миллионов. А long максимум может хранить примерно 9 квадриллионов (красивое слово).

Вспоминая бородатый анекдот про то, что начинающий программист думает, что в килобайте 1000 байт, а законченный программист считает, что в килограмме 1024 грамм, можем понять:

<pre class="lang-java line-numbers"><code>
1 mb = 1024 Kbyte = 1024 * 1024 = 1048576 bytes
1 int = 4 bytes
1 mb = 262144 int
</code></pre>
Кстати, внимательный читатель мог заметить, что на картинке всего 7 типов. 8 примитивный тип — это boolean.

boolean — это логический тип данных, который имеет всего два значения: true и false. Но возникает вопрос — какого он размера?

Ответит нам Java Virtual Machine Specifiaction и раздел "<a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.3.4" target="_blank" rel="nofollow">2.3.4. The boolean Type</a>":
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="a916768a-e91b-45cb-bb11-2365001aad19" data-max-width="1014" alt="Java: bits and bytes - 18" src="https://cdn.javarush.com/images/article/a916768a-e91b-45cb-bb11-2365001aad19/1024.jpeg"></div></div>То есть просто boolean будет занимать столько же, сколько и int. Если же мы объявим массив из boolean, то каждый элемент массива будет занимать 1 байт. Вот такие вот чудеса :)
<h2>Заключение</h2>Предлагаю ознакомиться ещё с парой материалов, для закрепления:
<ul>
<li>"<a href="https://www.youtube.com/watch?v=NLKQEOgBAnw" target="_blank" rel="nofollow">Hackerrank: Bit Manipulation</a>"</li>
<li>"<a href="https://www.youtube.com/watch?v=eXWjCgbL01U" target="_blank" rel="nofollow">Hackerrank: Solve 'Lonley Integer' Using Bit Manipulation</a>"</li>
<li>"<a href="https://www.youtube.com/watch?v=uUtb0BaeosQ&amp;list=PLJse9iV6ReqgcI4tec2jcyOZkaUKuGoHN" target="_blank" rel="nofollow">Bit Manipulation 01: Introduction</a>"</li>
<li>"<a href="https://www.youtube.com/watch?v=oCBlwsY8sR4" target="_blank" rel="nofollow">Coding Challenge #120: Bit Shifting</a>"</li>
</ul>#Viacheslav
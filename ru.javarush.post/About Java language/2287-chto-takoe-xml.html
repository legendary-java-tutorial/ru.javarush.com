XML в Java: Что это?
<p>----------------------------------------</p>
Привет! Сегодня мы познакомимся с еще одним форматом данных, который называется XML. Это очень важная тема. В работе над настоящими Java-приложениями ты почти наверняка столкнешься с задачами, связанными с XML. Этот формат используется в Java-разработке практически...
<p>----------------------------------------</p>
Привет! Сегодня мы познакомимся с еще одним форматом данных, который называется XML.

Это очень важная тема. В работе над настоящими Java-приложениями ты почти наверняка столкнешься с задачами, связанными с XML. Этот формат используется в Java-разработке практически повсеместно (зачем именно — узнаем ниже), поэтому рекомендую тебе читать лекцию не «по диагонали», а разобраться во всем досконально и заодно изучить дополнительную литературу/ссылки :) Это время точно не будет потрачено впустую.

Итак, начнем с простого — «что» и «зачем»!<h2>Что такое XML?</h2>XML расшифровывается как eXtensible Markup Language — «расширяемый язык разметки».
Один из языков разметки тебе, возможно, уже знаком: ты слышал об HTML, с помощью которого создаются веб-страницы :)<img data-id="a3084e6f-9bc8-466d-a616-847a47ae0da3" data-max-width="850" alt="Что такое XML - 1" src="https://cdn.javarush.com/images/article/a3084e6f-9bc8-466d-a616-847a47ae0da3/1024.jpeg">HTML и XML похожи даже внешне:
<table class="table table--auto-width">
<tbody><tr>
<td>
<span class="text-red"><strong>HTML 1</strong></span>
<pre><code>
<span class="text-user">&lt;h1&gt;</span>title<span class="text-user">&lt;/h1&gt;</span>
<span class="text-user">&lt;p&gt;</span>paragraph<span class="text-user">&lt;/p&gt;</span>
<span class="text-user">&lt;p&gt;</span>paragraph<span class="text-user">&lt;/p&gt;</span>
</code></pre></td>
<td><span class="text-corporate"><strong>XML 1</strong></span>
<pre><code>
<span class="text-user">&lt;headline&gt;</span>title<span class="text-user">&lt;/headline&gt;</span>
<span class="text-user">&lt;paragraph&gt;</span>paragraph<span class="text-user">&lt;/paragraph&gt;</span>
<span class="text-user">&lt;paragraph&gt;</span>paragraph<span class="text-user">&lt;/paragraph&gt;</span>
</code></pre>
</td></tr>
<tr>
<td>
<span class="text-red"><strong>HTML 2</strong></span>
<pre><code>
<span class="text-user">&lt;h1&gt;</span>title<span class="text-user">&lt;/h1&gt;</span>
<span class="text-user">&lt;p&gt;</span>paragraph<span class="text-user">&lt;/p&gt;</span>
<span class="text-user">&lt;p&gt;</span>paragraph<span class="text-user">&lt;/p&gt;</span>
</code></pre>
</td>
<td>
<span class="text-green"><strong>XML 2</strong></span>
<pre><code>
<span class="text-user">&lt;chief&gt;</span>title<span class="text-user">&lt;/chief&gt;</span>
<span class="text-user">&lt;paragraph&gt;</span>paragraph<span class="text-user">&lt;/paragraph&gt;</span>
<span class="text-user">&lt;paragraph&gt;</span>paragraph<span class="text-user">&lt;/paragraph&gt;</span>
</code></pre>
</td>
</tr>
</tbody></table>Иными словами, XML — это язык для описания данных.
<h2>Зачем нужен XML?</h2>XML изначально придумали для более удобного хранения и передачи данных, в том числе через Интернет.
У него есть ряд преимуществ, которые позволяют успешно справляться с этой задачей. 

Во-первых, он легко читается и человеком, и компьютером.

Думаю, ты без труда поймешь, что описывает этот xml-файл:

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;book&gt;
   &lt;title&gt;Harry Potter and the Philosopher’s Stone&lt;/title&gt;
   &lt;author&gt;J. K. Rowling&lt;/author&gt;
   &lt;year&gt;1997&lt;/year&gt;
&lt;/book&gt;
</code></pre>
Компьютер тоже без труда понимает такой формат.

Во-вторых, поскольку данные хранятся в простом текстовом формате, при их передаче с одного компьютера на другой не возникнет никаких проблем с совместимостью.

Важно понимать, что <strong>XML — это не исполняемый код, а язык описания данных</strong>. После того, как ты описал данные с помощью XML, тебе нужно написать код (например, на Java), который сможет эти данные отправить/принять/обработать.
<h2>Как устроен XML?</h2>Его главная составная часть — теги: вот такие штуки в угловых скобках:

<pre class="inline-block language-java"><code>
&lt;book&gt;
&lt;/book&gt;
</code></pre>

Теги бывают открывающими и закрывающими. У закрывающего есть дополнительный символ — “<code>/</code>”, это видно на примере выше.

Каждому открывающему тегу должен соответствовать закрывающий.
Они показывают, где начинается и где заканчивается описание каждого элемента в файле.

Теги могут быть вложенными!

В нашем примере с книгой у тега &lt;<strong>book</strong>&gt; есть 3 вложенных тега — &lt;<strong>title</strong>&gt;, &lt;<strong>author</strong>&gt; и &lt;<strong>year</strong>&gt;. 

Это не ограничивается одним уровнем: у вложенных тегов могут быть свои вложенные теги, и т. д. Такая конструкция называется деревом тегов.

Давай рассмотрим дерево на примере XML-файла с описанием автосалона:

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;carstore&gt;
   &lt;car category="truck"&gt;
       &lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
       &lt;year&gt;2005&lt;/year&gt;
       &lt;price currency="US dollar"&gt;200000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sedan"&gt;
       &lt;title lang="en"&gt;Ford Focus&lt;/title&gt;
       &lt;year&gt;2012&lt;/year&gt;
       &lt;price currency="US dollar"&gt;20000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sport"&gt;
       &lt;title lang="en"&gt;Ferrari 360 Spider&lt;/title&gt;
       &lt;year&gt;2018&lt;/year&gt;
       &lt;price currency="US dollar"&gt;150000.00&lt;/price&gt;
   &lt;/car&gt;
&lt;/carstore&gt;
</code></pre>
Здесь у нас есть тег верхнего уровня — &lt;<strong>carstore</strong>&gt;. Его еще называют «root» — корневой тег. 

У &lt;carstore&gt; есть один дочерний тег — &lt;car&gt;. У &lt;car&gt;, в свою очередь, тоже есть 3 своих дочерних тега — &lt;model&gt;, &lt;year&gt; и &lt;price&gt;.
 
Каждый тег может иметь атрибуты — дополнительную важную информацию. В нашем примере у тега &lt;model&gt; есть атрибут «lang» — язык, на котором написано название модели:

<pre class="lang-java line-numbers"><code>
&lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
</code></pre>
Так мы можем указать, что название написано на английском языке.

У нашего тега &lt;price&gt; (цена) есть атрибут «currency» — «валюта».

<pre class="lang-java line-numbers"><code>
&lt;price currency="US dollar"&gt;150000.00&lt;/price&gt;
</code></pre>
Так мы можем указать, что цена за машину указана в американских долларах.

Таким образом, <strong>у XML есть «самоописывающий» синтакс</strong>. Ты можешь добавить любую нужную тебе информацию для описания данных.

Также в начало файла можно добавить строку с указанием версии XML и кодировки, в которой записаны данные.

Она называется «<strong>prolog</strong>» и выглядит вот так:

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</code></pre>
Мы применяем XML версии 1.0 и кодировку UTF-8. Это не обязательно, но может пригодиться, если ты, например, используешь в своем файле текст на разных языках.

Мы упомянули о том, что XML переводится как «расширяемый язык разметки», но что значит «расширяемый»?

Это означает, что он отлично приспособлен для создания новых версий твоих объектов и файлов. 

К примеру, мы хотим, чтобы в нашем автосалоне начали продавать еще и мотоциклы!

При этом в программе нам нужно поддерживать обе версии &lt;carstore&gt; — и старую (без мотоциклов), и новую.

Вот наша старая версия:

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;carstore&gt;
   &lt;car category="truck"&gt;
       &lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
       &lt;year&gt;2005&lt;/year&gt;
       &lt;price currency="US dollar"&gt;200000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sedan"&gt;
       &lt;title lang="en"&gt;Ford Focus&lt;/title&gt;
       &lt;year&gt;2012&lt;/year&gt;
       &lt;price currency="US dollar"&gt;20000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sport"&gt;
       &lt;title lang="en"&gt;Ferrari 360 Spider&lt;/title&gt;
       &lt;year&gt;2018&lt;/year&gt;
       &lt;price currency="US dollar"&gt;150000.00&lt;/price&gt;
   &lt;/car&gt;
&lt;/carstore&gt;
</code></pre>
А вот новая, расширенная:

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;carstore&gt;
   &lt;car category="truck"&gt;
       &lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
       &lt;year&gt;2005&lt;/year&gt;
       &lt;price currency="US dollar"&gt;200000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sedan"&gt;
       &lt;title lang="en"&gt;Ford Focus&lt;/title&gt;
       &lt;year&gt;2012&lt;/year&gt;
       &lt;price currency="US dollar"&gt;20000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sport"&gt;
       &lt;title lang="en"&gt;Ferrari 360 Spider&lt;/title&gt;
       &lt;year&gt;2018&lt;/year&gt;
       &lt;price currency="US dollar"&gt;150000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;motorcycle&gt;
       &lt;title lang="en"&gt;Yamaha YZF-R6&lt;/title&gt;
       &lt;year&gt;2018&lt;/year&gt;
       &lt;price currency="Russian Ruble"&gt;1000000.00&lt;/price&gt;
       &lt;owner&gt;Vasia&lt;/owner&gt;
   &lt;/motorcycle&gt;
   &lt;motorcycle&gt;
       &lt;title lang="en"&gt;Harley Davidson Sportster 1200&lt;/title&gt;
       &lt;year&gt;2011&lt;/year&gt;
       &lt;price currency="Euro"&gt;15000.00&lt;/price&gt;
       &lt;owner&gt;Petia&lt;/owner&gt;
   &lt;/motorcycle&gt;
&lt;/carstore&gt;
</code></pre>
Вот так легко и просто мы добавили описание мотоциклов в наш файл :)

При этом нам совершенно не нужно задавать для мотоциклов те же дочерние теги, что и для машин. Обрати внимание, что у мотоциклов, в отличие от машин, есть элемент &lt;owner&gt; — владелец.

Это никак не помешает компьютеру (да и человеку тоже) прочитать данные.
<h2>Отличия XML от HTML</h2>Мы уже сказали, что XML и HTML внешне очень похожи. Поэтому, очень важно знать, чем они отличаются.

Во-первых, они используются для разных целей.

<strong>HTML — для разметки веб-страниц.</strong> Например, если тебе нужно создать веб-сайт, с помощью HTML ты сможешь указать: «Меню должно быть в верхнем правом углу. В нем должны быть такие-то кнопки». Иными словами, задача HTML — отображение данных.

<strong>XML — для хранения и передачи информации</strong> в удобном для человека и компьютера виде. Этот формат не содержит никаких указаний на то, как эти данные нужно отображать: это зависит от кода самой программы.

Во-вторых, у них есть основное техническое отличие. Теги HTML являются заранее заданными («predefined»).

Иными словами, для создания заголовка (например, большой надписи в начале страницы) в HTML используются только теги &lt;h1&gt;&lt;/h1&gt; (для заголовков поменьше — &lt;h2&gt;&lt;/h2&gt;,&lt;h3&gt;&lt;/h3&gt;). Не получится создать заголовки в HTML, используя теги с другими названиями.

XML не использует заранее заданные теги. Ты можешь давать тегам любые названия, какие захочешь — &lt;header&gt;, &lt;title&gt;, &lt;idontknow2121&gt;.
<h2>Разрешение конфликтов</h2>Свобода, которую предоставляет XML, может привести и к некоторым проблемам.

К примеру, одна и та же сущность (например, машина) может использоваться программой в разных целях.

К примеру, у нас есть XML-файл в котором описаны машины. Однако, наши программисты не договорились заранее между собой. И теперь, помимо данных реальных автомобилей, в наши xml попадают еще и данные игрушечных моделей! Более того, у них одинаковые атрибуты.

В нашу программу приходит вот такой XML-файл. Как же нам отличить настоящую машину от игрушечной модельки?

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;carstore&gt;
   &lt;car category="truck"&gt;
       &lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
       &lt;year&gt;2005&lt;/year&gt;
       &lt;price currency="US dollar"&gt;200000.00&lt;/price&gt;
   &lt;/car&gt;
   &lt;car category="sedan"&gt;
       &lt;title lang="en"&gt;Ford Focus&lt;/title&gt;
       &lt;year&gt;2012&lt;/year&gt;
       &lt;price currency="US dollar"&gt;100.00&lt;/price&gt;
   &lt;/car&gt;
&lt;/carstore&gt;
</code></pre>
Здесь нам помогут префиксы и пространства имен.

Чтобы отделять в нашей программе игрушечные машины от настоящих (да и вообще — любые игрушечные вещи от их реальных прототипов), мы вводим два  префикса — «real» и «toy».

<pre class="lang-java line-numbers"><code>
&lt;real:car category="truck"&gt;
   &lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
   &lt;year&gt;2005&lt;/year&gt;
   &lt;price currency="US dollar"&gt;200000.00&lt;/price&gt;
&lt;/real:car&gt;
&lt;toy:car category="sedan"&gt;
   &lt;title lang="en"&gt;Ford Focus&lt;/title&gt;
   &lt;year&gt;2012&lt;/year&gt;
   &lt;price currency="US dollar"&gt;100.00&lt;/price&gt;
&lt;/toy:car&gt;
</code></pre>
Теперь наша программа сможет различить сущности! Все, что имеет префикс toy, будет отнесено к игрушкам :)

Однако, мы пока не закончили. Чтобы использовать префиксы, нам надо зарегистрировать каждый из них в качестве пространства имен (namespace). 

Ну, на самом деле, «зарегистрировать» — это громко сказано :) Достаточно просто придумать уникальное имя для каждого из них.

Это как с классами: у класса есть короткое имя (<code>Cat</code>) и полное имя с указанием всех пакетов (<code>zoo.animals.Cat</code>)

<strong>Для создания уникальных имен namespace обычно используют URI</strong>. Иногда сюда подставляют адрес в Сети, где подробно описаны функции предназначение этого пространства имен.

Но это не обязательно должен быть действующий интернет-адрес. Очень часто на проектах используют просто URI-подобные строки, которые помогают отследить иерархию пространств имен.

Вот пример:

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;carstore xmlns:real="http://testproject.developersgroup1.companyname/department2/namespaces/real"
         xmlns:toy="http://testproject.developersgroup1.companyname/department2/namespaces/toy"&gt;
&lt;real:car category="truck"&gt;
   &lt;model lang="en"&gt;Scania R 770&lt;/model&gt;
   &lt;year&gt;2005&lt;/year&gt;
   &lt;price currency="US dollar"&gt;200000.00&lt;/price&gt;
&lt;/real:car&gt;
&lt;toy:car category="sedan"&gt;
   &lt;title lang="en"&gt;Ford Focus&lt;/title&gt;
   &lt;year&gt;2012&lt;/year&gt;
   &lt;price currency="US dollar"&gt;100.00&lt;/price&gt;
&lt;/toy:car&gt;
&lt;/carstore&gt;
</code></pre>
Конечно, в Сети нет никакого сайта по адресу <a href="http://testproject.developersgroup1.companyname/department2/namespaces/real" rel="nofollow" target="_blank">http://testproject.developersgroup1.companyname/department2/namespaces/real</a>

Но тут есть полезная информация: за создание пространства имен «real» отвечает группа разработчиков «developersgroup1» из отдела «department2». Если нужно будет внести новые имена, или обсудить с ними возможные конфликты, мы знаем куда обратиться.

Иногда в качестве уникального имени для namespace используют реальный адрес в Сети с описанием этого пространства имен. Например, если это большая компания, и ее проект будет использоваться миллионами людей по всему миру. Но это делается далеко не всегда: на <a href="https://stackoverflow.com/questions/27613891/must-an-xml-namespace-name-uri-be-retrievable" rel="nofollow" target="_blank">Stackoverflow</a> есть обсуждение этого вопроса.

В принципе, требование использовать URI в качестве имен для namespace не является строгим: можно и просто рандомные строки.

Такой вариант тоже будет работать:

<pre class="lang-java line-numbers"><code>
xmlns:real="nvjneasiognipni4435t9i4gpojrmeg"
</code></pre>
Но у использования URI есть ряд преимуществ. Подробнее об этом ты можешь почитать <a href="https://stackoverflow.com/questions/55883482/why-cant-we-use-random-strings-instead-of-uris-for-xml-namespaces" rel="nofollow" target="_blank">вот тут</a>.
<h2>Основные стандарты XML</h2><strong>Стандарты XML — это набор расширений, которые придают xml-файлам дополнительные возможности.</strong>

XML имеет очень много стандартов, но мы лишь посмотрим на самые важные из них, и узнаем, что они позволяют делать

<strong>AJAX</strong> — один из самых известных стандартов XML. Он позволяет изменять содержимое веб-страницы без ее перезагрузки! Звучит круто? :) Можешь испробовать эту технологию лично <a href="https://www.w3schools.com/xml/ajax_intro.asp" rel="nofollow" target="_blank">вот тут</a>. 

<strong>XSLT</strong> — позволяет преобразовывать XML-текст в другие форматы. Например, используя XSLT, ты можешь преобразовать XML в HTML! Задача XML, как мы уже говорили, — описание данных, а не отображение. Но с использованием XSLT мы можем обойти это ограничение!

<a href="https://www.w3schools.com/xml/xsl_intro.asp" rel="nofollow" target="_blank">Вот здесь</a> есть «песочница» с работающим примером, где ты можешь сам посмотреть как это работает :)

<strong>XML DOM</strong> — позволяет получать, изменять, добавлять или удалять отдельные элементы из XML-файла.

Вот небольшой пример как это работает. У нас есть файл books.xml:

<pre class="lang-java line-numbers"><code>
&lt;bookstore&gt;
   &lt;book category="cooking"&gt;
       &lt;title lang="en"&gt;Everyday Italian&lt;/title&gt;
       &lt;author&gt;Giada De Laurentiis&lt;/author&gt;
       &lt;year&gt;2005&lt;/year&gt;
       &lt;price&gt;30.00&lt;/price&gt;
   &lt;/book&gt;
   &lt;book category="children"&gt;
       &lt;title lang="en"&gt;Harry Potter&lt;/title&gt;
       &lt;author&gt;J K. Rowling&lt;/author&gt;
       &lt;year&gt;2005&lt;/year&gt;
       &lt;price&gt;29.99&lt;/price&gt;
   &lt;/book&gt;
&lt;/bookstore&gt;
</code></pre>
В нем две книги. У книг есть такой элемент как заголовок — &lt;title&gt;.

А вот тут мы при помощи JavaScript можем получить из нашего XML-файла все заголовки книг и вывести первый из них в консоль:

<pre class="lang-java line-numbers"><code>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;

&lt;p id="demo"&gt;&lt;/p&gt;

&lt;script&gt;
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 &amp;&amp; this.status == 200) {
  myFunction(this);
  }
};
xhttp.open("GET", "books.xml", true);
xhttp.send();

function myFunction(xml) {
    var xmlDoc = xml.responseXML;
  document.getElementById("demo").innerHTML =
  xmlDoc.getElementsByTagName("title")[0].childNodes[0].nodeValue;
}
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
Опять же, рекомендую посмотреть, как работает этот пример, используя <a href="https://www.w3schools.com/xml/dom_intro.asp" rel="nofollow" target="_blank">песочницу</a>:)

<strong>DTD</strong> («document type definition») — позволяет определить список разрешенных элементов для какой-то сущности в XML-файле. 

К примеру, мы работаем над сайтом книжного магазина, и все команды разработчиков договорились, что для элемента book в XML-файлах должны быть указаны только атрибуты title, author и year.

Но как нам защитить себя от невнимательности? 

Очень легко!

<pre class="lang-java line-numbers"><code>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE book [
       &lt;!ELEMENT book (title,author,year)&gt;
       &lt;!ELEMENT title (#PCDATA)&gt;
       &lt;!ELEMENT author (#PCDATA)&gt;
       &lt;!ELEMENT year (#PCDATA)&gt;
       ]&gt;

&lt;book&gt;
   &lt;title&gt;The Lord of The Rings&lt;/title&gt;
   &lt;author&gt;John R.R. Tolkien&lt;/author&gt;
   &lt;year&gt;1954&lt;/year&gt;
&lt;/book&gt;
</code></pre>
Здесь мы определили список допустимых атрибутов для &lt;book&gt;. Попробуй добавить туда новый элемент — и сразу получишь ошибку!

<pre class="lang-java line-numbers"><code>
&lt;book&gt;
   &lt;title&gt;The Lord of The Rings&lt;/title&gt;
   &lt;author&gt;John R.R. Tolkien&lt;/author&gt;
   &lt;year&gt;1954&lt;/year&gt;
   &lt;mainhero&gt;Frodo Baggins&lt;/mainhero&gt;
&lt;/book&gt;
</code></pre>
Ошибка! “Element mainhero is not allowed here”

Есть и много других XML-стандартов. Ознакомиться с каждым из них и попробовать «поковыряться» в коде ты можешь на <a href="https://www.w3schools.com/xml/default.asp" rel="nofollow" target="_blank">сайте WC3</a> (раздел «Important XML Standarts»).

Да и вообще, если тебе нужна информация по XML, там можно найти практически все :)

Ну а наша лекция на этом подошла к концу.
Настало время вернуться к задачам! :)

До встречи!
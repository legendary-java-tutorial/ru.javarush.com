Как тестовое задание на собеседование превратилось в open-source библиотеку
<p>----------------------------------------</p>
В этой статье я опишу как тестовое задание в одну из контор превратилось в реальную библиотеку, которую используют! Как прикольно и увлекательно создавать вещи, которые кому-то нужны.
<p>----------------------------------------</p>
<strong>Всем привет, JavaRush сообщество!</strong>

Немного о себе: с весны 2016 года работаю в качестве Java Software Engineer. Люблю сюда заходить и решаю задачи, что не решил еще во время учебы.

Сегодня расскажу вам о библиотеке - <a href="https://github.com/romankh3/image-comparison" target="_blank" rel="nofollow">Image Comparison</a>. Это open source библиотека, которая хранится в открытом доступе на <a href="https://github.com" target="_blank" rel="nofollow">GitHub</a>.
<img data-id="8f116cfb-1717-4041-ace8-052e2dcd231d" data-max-width="850" alt="Как тестовое задание на собеседование превратилось в open-source библиотеку - 1" src="https://cdn.javarush.com/images/article/8f116cfb-1717-4041-ace8-052e2dcd231d/1024.jpeg">Цель данной статьи донести, что создание open source продукта — это не просто трата времени впустую, нет! Это богатый опыт, который черпается с разных сторон, когда в твоей власти весь процесс разработки, когда нужно вникать в каждую деталь. Open Source — это мир вокруг вас. Я не шучу, за время существования этой библиотеки, общался с людьми с разных стран, таких как: США, Индии, Китая, Египта, России, Германии, Украины, Швеции, Новой Зеландии, Норвегии. То есть это реальный опыт совместной разработки, нахождения компромисcов, проверки кода и так далее.

Это было вступление, теперь начнем всё по порядку:
<h2>Тестовое задание. Начало августа 2017 года</h2>Началось все с того, что я собеседовался в одну из компаний, где первым этапом нужно было написать тестовое задание. Задача состояла в том, чтоб написать код, который бы сравнивал две картинки, с одинаковыми размерами, находил отличия между ними, группировал их и рисовал прямоугольник вокруг них.

Есть первая картинка:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="a3f8f838-0bda-4d5c-84e0-4257ca14e853" data-max-width="985" alt="Как тестовое задание на собеседование превратилось в open-source библиотеку - 2" src="https://cdn.javarush.com/images/article/a3f8f838-0bda-4d5c-84e0-4257ca14e853/1024.jpeg"></div></div>Есть вторая картинка:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="c410832c-4ad0-4b14-9cc7-aa72325ef2b1" data-max-width="985" alt="Как тестовое задание на собеседование превратилось в open-source библиотеку - 3" src="https://cdn.javarush.com/images/article/c410832c-4ad0-4b14-9cc7-aa72325ef2b1/1024.jpeg"></div></div>Нужно было найти отличия и обвести их как показано ниже:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="411ef479-a9e3-4757-8d81-086c702aaa41" data-max-width="985" alt="Как тестовое задание на собеседование превратилось в open-source библиотеку - 4" src="https://cdn.javarush.com/images/article/411ef479-a9e3-4757-8d81-086c702aaa41/1024.jpeg"></div></div>Как можно заметить, в поле <strong>Username</strong> есть отличие, которое и было обведено красным треугольником. <a href="https://javarush.com/groups/posts/1700-testovoe-zadanie-image-comparison" target="_blank" rel="nofollow">Более детальное описание задачи</a>.

Я решил, что хочу сделать не только правильно с точки зрения функционала, но еще и красиво, чтобы было не стыдно. Для этого решил, что опубликую это как проект на <a href="https://github.com/" target="_blank" rel="nofollow">GitHub</a>. Давно хотел изучить GitHub, получить опыт работы с ним. После быстрого просмотра, нашел что хорошо бы добавить сторонние сервисы по анализу качества кода, по генерации покрытия кода тестами и тд.

Добавил такие инструменты:
<ul>
<li><p><a href="https://app.codacy.com/" target="_blank" rel="nofollow">Codacy </a> — качество кода. Действительно стоит обратить на него внимание.</p></li>
<li><p><a href="https://travis-ci.org/" target="_blank" rel="nofollow">Travis CI</a> — это CI(continuous integration) инструмент, который собирает проект, прогоняет тесты и говорит, успешно ли собран проект. Например, если какой-то из тестов не прошел в следствии с новыми изменениями, то он скажет, что сборка проекта неудачная и окрасит ее красным цветом.</p></li>
<li><p><a href="https://coveralls.io/" target="_blank" rel="nofollow">Coveralls</a> — это инструмент, который показывает какой процент кода покрыт тестами.</p></li>
<li><p><a href="https://bettercodehub.com/" target="_blank" rel="nofollow">BetterCode Hub</a> еще один инструмент по анализу качества кода. Очень полезная вещь, которая не только скажет, что плохо, но и опишет почему и даст ссылку на книгу, в которой можно почерпнуть знания об этом.</p></li>
</ul>Каждый из этих сервисов имеет свой бейджик с результатами данных, например проект покрытия кода. И этот бейджик можно добавить в главном описании проекта — README файл. 

Задание было готово — отдал его на ревью. После ревью сразу же по свежей памяти создал на каждое замечание <a href="https://guides.github.com/features/issues/" target="_blank" rel="nofollow">Github Issue</a>, которые потом помогли бы мне улучшить этот проект. Задачи от работодателя по улучшению не было, поэтому на некоторое время я забыл о проекте...
<h2>Путь Библиотеки. Июль 2018 года</h2><h3>Логотип</h3>В один момент я обнаружил, что на мой проект заходят часто люди, причем это происходит каждый день. Меня это поразило, еще больше поразило то, что где-то через год создали ISSUE, в котором было написано, что некий графический дизайнер предлагает мне создать логотип моего проекта. Мол он любит делать это для Opensource продуктов и сделает это абсолютно бесплатно. Мы начали сотрудничать. Было предложено несколько вариантов, в конечном счете остановились на этом:
<div class="row justify-content-center jr-image-wrap"><div class="col-12 col-sm-10 col-md-8"><img data-id="1c333643-763b-4202-855c-62656ffb1ea7" data-max-width="1001" alt="Как тестовое задание на собеседование превратилось в open-source библиотеку - 5" src="https://cdn.javarush.com/images/article/1c333643-763b-4202-855c-62656ffb1ea7/1024.jpeg"></div></div>Я тогда еще был молод и незнаком с opensource сообществом и сам факт такого предложения мне был диким и я спросил, а зачем он это делает? На что он мне ответил: "Lolz oh, just cause i love contributing to open source projects. Kind of a life goals thing..." (<a href="https://github.com/romankh3/image-comparison/issues/20" target="_blank" rel="nofollow">само issue здесь</a>).

Вот тогда то я и ощутил впервые как это здорово, когда через opensource проекты тебя находят разные люди и предлагают такие интересные вещи!
<h3>Первый Дефект со стороны</h3>Я заметил, что некий разработчик из Китая, создал мне <a href="https://github.com/romankh3/image-comparison/issues/21" target="_blank" rel="nofollow">issue</a>, в котором он описал, что нашел дефект в работе библиотеки, что если использовать большие картинки, то получается <strong>StackOverflowError</strong>. Человек решил воспользоваться и нашел ошибку. Причем не просто нашел. а еще и написал о ней. Это новый шаг в развитии библиотеки. Причем реально решения у меня не было. 

В определенный момент, один из тестировщиков из России предложил решение. Но оно было сырое и сделано не как полагается и я не принял его. А когда уже нужно было публиковать библиотеку в Maven Central, нужно было что-то решать с этим дефектом, не хотелось выкладывать вместе с ним.

К тому же был еще один дефект, который я так и не починил и он тоже приносил много неудобств. 
<h2>Command Line Usage. Осень 2018 года</h2>Следующим этапом в развитии было общение с шведом (Renato Athaydes), который захотел использовать библиотеку через командную строку и для этого нужно было внести некоторые изменения и дополнения. 
Я опять был поражен и удивлен этим. После того, как мне писал графический дизайнер удивление мое было несколько меньше, но все еще очень высоко. От мысли, что мой код кому-то реально нужен меня переполняли невероятные чувства.
 
Он сделал необходимые изменения, подготовил код. Я провел code review, то есть просмотрел изменения, были комментарии, которые были изменены и изменения были уже в библиотеке. Эти изменения я обозначил как версию <a href="https://github.com/romankh3/image-comparison/releases/tag/V2.0" target="_blank" rel="nofollow">v2.0</a>

Следующим этапом было добавление библиотеки в Maven Central — центральное хранилище, откуда можно будет скачать его для любого проекта и использовать как зависимость (dependency).

На тот момент я понятия не имел как это сделать, даже отдаленно, поэтому я сослался на занятость и попросил выполнить его все действия, которые необходимы для настройки на проекте. Но этого оказалось вовсе не достаточно и самое интересное было как раз в том, чтоб настроить связь с Maven Central. Это дикая боль, которую с первого раза я так и не смог, и реально только 15 апреля у меня получилось опубликовать проект на Maven Central. Это было нелегко, но как любят говорить другие: "через это проходят все, кто хочет опубликовать свой код на Java".

До того, как я опубликовал библиотеку я таки нашел что и как делать с дефектами, которые тянулись уже давно и выпустил новую версию <a href="https://github.com/romankh3/image-comparison/releases/tag/2.0.2" target="_blank" rel="nofollow">v2.0.2</a>, в которой я поблагодарил всех тех, кто помог мне, описал что и как я сделал. 
<h2>Публикация в Maven Central. Весна 2019</h2>Чтоб правильно опубликовать библиотеку, нужно хорошо разобраться с версионированием, как правильно выставлять версии. Я придержусь такой схемы:
<ul><li><strong>XX.YY.BBBB</strong>, где <strong>XX</strong> — это мажорное обновление версии, которое влечет изменения несовместимые с предыдущим.(например изменение возвращающего результата в методах);</li>
<li><strong>YY</strong> — это минорное обновление — изменение внутреннее или расширение, которое не изменяет то, что есть <strong>BBBB</strong> — это дефекты, которые были починены.</li>
<li>Например версия <strong>2.0.2</strong> — значит ,что мажорная версия 2, минорных обновлений не было, и есть два обновления по дефектам.</li>
</ul>Далее было важно разобраться как правильно поставить <strong>groupId</strong>, <strong>artifactId</strong>. Их нужно было выбрать один раз и использовать далее. А из них состоит пакет, в котором хранится код.

Было: <strong>ua.comparison.image</strong>
Стало: <strong>com.github.romankh3.image.comparison</strong>
И это явно лучше, так как всем известно, что это проект из GitHub и можно его найти у человека с ником romankh3.

Когда все я это сделал, выпустил новую версию <a href="https://github.com/romankh3/image-comparison/releases/tag/2.1.0" target="_blank" rel="nofollow">v2.1.0</a>.
<h2>Общение со Шведами. Май 2019 года</h2>После того как я опубликовал библиотеку, мне написал на почту другой швед (Mika Kytöläinen) и попросил, чтоб его знакомый сделал изменения в моей библиотеке. Говорит, что это ему очень нужно и он будет очень рад, если мы это сделаем и сделаем быстро. Я конечно был не против изменений, которые нужны.

Он предложил добавить конфигурацию толщины линии, которая рисует прямоугольник. Мол, для тех кто плохо видит — это будет полезное изменение. <a href="https://github.com/romankh3/image-comparison/pull/78" target="_blank" rel="nofollow">Подготовил код</a>. Добавив еще несколько изменений, выпустил версию <a href="https://github.com/romankh3/image-comparison/releases/tag/2.2.0" target="_blank" rel="nofollow">v2.2.0</a>
<h2>Общение с немцем. Май 2019 года</h2>После этого один немец создал <a href="https://github.com/romankh3/image-comparison/issues/62" target="_blank" rel="nofollow">issue</a>, в котором говорит, что хочет использовать для тестирования, но ему не хватает функционала. Он сделал много предложений, которые были очень интересные, он предложил вместо того, чтоб в результате сравнения возвращать только создающуюся картинку с результатом, возвращать набор данных: то, что сравнивалось, результат(если нужно) и состояние в котором будет MATCH, MISMATCH, SIZE_MISMATCH. 

Даже выполнил изменения. Но они совсем не учитывали предыдущий код и были сделаны наспех. Я отклонил их и предложил выполнить так, как я считаю нужным. Несмотря на это, он больше отвечал и я решил, что сам сделаю это и выпущу новую версию.

Вместе с тем, Mika Kytöläinen предложил еще интересный функционал — добавить области, которые бы не участвовали в сравнении. Это реальный кейс.
И все это было выпущено в <a href="https://github.com/romankh3/image-comparison/releases/tag/3.0.0" target="_blank" rel="nofollow">v3.0.0</a>
<h2>Использование в реальном проекте</h2>В конце мая мне написал тестировщик-автоматизатор из Киева, который заинтересовался библиотекой и хочет ее использовать в реальном проекте, который приносит деньги. Это был прорыв! Использование где-то в pet-project это одно, а использовать в реальном проекте — это совсем другое дело. Мы обсудили что и как работает. Применение очень интересное: у них в приложении есть чеки, которые печатают и нужно было проверять, что чеки создаются по определенному шаблону и он не меняется. Но была проблема, что такие секции как дата и время всегда менялись и их нужно было игнорировать. У нас уже был добавлен функционал на игнорирование некоторых областей, но он оказался еще очень сырым для реального использования и мы еще плодотворно поработали вместе несколько недель над этим. Результатом стал выпуск версии <a href="https://github.com/romankh3/image-comparison/releases/tag/3.1.1" target="_blank" rel="nofollow">v3.1.1</a>
<h2>Поиск ниши</h2>После этого я понял, что реальная ниша для моей библиотеки — использование ее в тестах. Для этого я решил найти какой-то форум для тестировщиков и написать им об этом, чтоб получить какой-то отзыв и увеличить известность. Нашел русскоязычный форум и там опубликовал статью <a href="https://automated-testing.info/t/organizacziya-testirovaniya-kartinok-sravnenie-dvuh-pohozhih/22765" target="_blank" rel="nofollow">Организация тестирования картинок — сравнение двух похожих</a>. В ней я получил реальный отзыв о коде и функционале, который я применил и выпустил новую версию <a href="https://github.com/romankh3/image-comparison/releases/tag/3.2.0" target="_blank" rel="nofollow">v3.2.0</a>, а затем и <a href="https://github.com/romankh3/image-comparison/releases/tag/3.3.0" target="_blank" rel="nofollow">v.3.3.0</a>.
<h2>Сейчас</h2>Сейчас библиотека имеет 60 звезд на Github, у нее 33 форков. Я считаю, что это очень здорово с учетом того, что я его никак не пиарил кроме статьи на форуме для автоматизаторов.

Спасибо всем, кто дочитал до конца. Реально оказалось намного больше статья, чем я ожидал.

<a href="https://blog.bintray.com/2014/02/11/bintray-as-pain-free-gateway-to-maven-central/" target="_blank" rel="nofollow">Статья о том, как опубликовать библиотеку в Maven Central.</a>

<strong>Если есть что добавить — пишите!
Если есть что предложить по улучшению библиотеки — пишите! Я все прочту и должным образом уделю на это время.</strong>

<strong>Всем кому статья понравилась и была полезна — оценивайте и пишите в комментариях.</strong>

<strong>Также, подписывайтесь на мой гитхаб аккаунт <a href="https://github.com/romankh3" target="_blank" rel="nofollow">romankh3</a></strong>

Смотрите также мои другие статьи:
<ul>
<li><a href="https://javarush.com/groups/posts/2301-tekhnicheskie-voprosih-na-sobesedovanii" target="_blank" rel="nofollow">Технические вопросы на собеседовании</a></li>
<li><a href="https://javarush.com/groups/posts/2302-kak-nayti-rabotu-sovetih-po-rassihlke-rezjume" target="_blank" rel="nofollow">Как найти работу? Советы по рассылке резюме</a></li>
<li><a href="https://javarush.com/groups/posts/2327-professionaljhnoe-vihgoranie-kak-ustojatjh" target="_blank" rel="nofollow">Профессиональное выгорание. Как устоять?</a></li>
<li><a href="https://javarush.com/groups/posts/2306-20-chasov-v-nedelju-programmirovanija-magistratura-i-lichnaja-zhiznjh" target="_blank" rel="nofollow">История Успеха. 20 часов программирования в неделю, магистратура и личная жизнь</a></li>
<li><a href="https://javarush.com/groups/posts/2400-sozdanie-sistemih-monitoringa-cen-na-aviabiletih-poshagovoe-rukovodstvo" target="_blank">Создание системы мониторинга цен на авиабилеты: пошаговое руководство [Часть 1]</a></li>
<li><a href="https://javarush.com/groups/posts/2430-gayd-po-sozdaniju-klienta-dlja-skyscanner-api-i-ego-publikacii-v-jcenver-i-maven-central" target="_blank">Гайд по созданию клиента для Skyscanner API и его публикации в jCenter и Maven Central [Часть 1]</a></li>
<li><a href="https://javarush.com/groups/posts/2388-logirovanie-chto-kak-gde-i-chem" target="_blank">Логирование: что, как, где и чем?</a></li>
<li><a href="https://javarush.com/groups/posts/2463-debug-v-intellij-idea-gayd-dlja-novichkov" target="_blank">Debug в Intellij IDEA: гайд для новичков</a></li>
</ul>
Разбираем базы данных и язык SQL - "Java-проект от А до Я"
<p>----------------------------------------</p>
Алоха, инженеры-программисты. Сегодня говорим о базах данных и языке SQL. На кого рассчитана эта статья? Да на всех, кому интересно. Одни могут начать свой путь с этой статьи, другие смогут освежить в памяти интересные факты. Эта часть будет сугубо теоретической...
<p>----------------------------------------</p>
<em>Статья из серии о создании Java-проекта. Ее цель — разбор ключевых технологий, итог — написание телеграм-бота. Вводная часть — <a href="https://javarush.com/groups/posts/2935-java-proekt-ot-a-do-ja-pishem-realjhnihy-proekt-dlja-portfolio" target="_blank">здесь</a>.</em>

Алоха, инженеры-программисты. Сегодня говорим о базах данных и языке SQL.<img data-max-width="800" data-id="9f277c28-24c5-435f-9b0b-e875955ec272" src="/images/article/9f277c28-24c5-435f-9b0b-e875955ec272/800.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 1">На кого рассчитана эта статья? Да на всех, кому интересно. Одни могут начать свой путь с этой статьи, другие смогут освежить в памяти интересные факты. Эта часть будет сугубо теоретической. 

Прежде чем рассказывать, что такое базы данных и SQL-синтаксис, нужно понять и определить, для чего мы их будем изучать. 

На данном этапе будем говорить <span class="text-bold">ТОЛЬКО</span> об SQL базах данных: NoSQL в этом цикле статей рассматривать не будем.<h2>База данных: что это</h2><img data-max-width="800" data-id="ca82157c-becb-4585-9d40-0498b7508086" src="/images/article/ca82157c-becb-4585-9d40-0498b7508086/800.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 2">База данных (далее БД) — это место, где хранятся <span class="text-bold">структурированные данные</span>, которые можно получить при помощи языка запросов. 

Базы данных умеют не только хранить, но и обрабатывать и изменять информацию в больших объемах. 

Для ремарки: попробуйте быстро изменить в Excel набор значений по каким-то признакам. В принципе, ничего сложного. 

Не то что в нашем не оцифрованном реальном мире. Например, переименование переулков, улиц, городов. Было бы все виртуально и занесено в БД, была бы она нормализована, это была бы пара пустяков. А так страдает множество носителей данных, которые не могут автоматически измениться. 

В этом контексте SQL для баз данных — это язык, который БД понимает и реагирует соответственно.

Скажем, переименовать город не составило бы труда, переименование Днепропетровска в Днипро выглядело бы примерно так:

<pre class="lang-java line-numbers"><code>
UPDATE city SET name = “Днипро” WHERE id = 1231;
</code></pre>
Все последующие запросы в систему уже выдавали бы то имя, которое нам нужно.<h2>Зачем нужны базы данных</h2>Как я уже говорил, при помощи баз данных можно хранить данные. Но что это за данные? 

Чтобы понять на жизненном примере, можно поговорить о каком-то приложении. Например, о том же телеграм-боте. 

Мы хотим знать, сколько человек пользуется ботом. Как это можно реализовать? В обычном Java-приложении можно создать множество уникальных элементов — Set, которое будет хранить nickname пользователя или ID-шник чата. 

Будет это работать? Будет. Ровно до тех пор, пока Java-приложение не остановят, а как только его запустят вновь, то множество уникальных элементов будет пустым. То есть данные, которые хранились в работающем приложении, просто пропали. 

Что можно с этим сделать? Можно вынести хранение состояния системы (данные) из Java-приложения куда-то в другое место. Можно хранить это в CSV-формате в обычном файле на компьютере. Можно вообще одной строкой в отдельном файле. Это можно сделать, и потом перезаписывать эти данные перед тем, как Java-приложение остановится. Хотя гарантия, что запись будет успешная, далеко не близка к 100%, потому что банально можно выдернуть шнур питания сервера, и запись не произойдет. 

В этом подходе есть существенный недостаток: нет никакой функциональности по получению, агрегированию и поиску информации на уровне файлов. Да, конечно, можно вычитать файл, создать под него объекты, но при этом придется КАЖДЫЙ раз выкачивать в приложение все данные. А их может быть много, например, пара гигабайт.

Этого можно избежать, если хранить данные в БД. Каким образом? Через таблицы и отношения между ними. На этом все реляционные базы данных и стоят.<h2>SQL: язык, который понимают базы данных</h2>Существуют Системы Управления Базами Данных (далее — СУБД) и язык, который они понимают — SQL. 

SQL — язык программирования для манипулирования и управления базами данных.

Для понимания, как это работает, посмотрим на рисунок:<img data-max-width="800" data-id="c207fb5c-f0af-4175-a5e3-ca9108698563" src="/images/article/c207fb5c-f0af-4175-a5e3-ca9108698563/800.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 3">Пользователь отправляет SQL-запросы в СУБД, СУБД понимает, что нужно сделать, делает это, и если запрос был на получение данных, то возвращает их. Поэтому нам как разработчикам нужно освоить язык запросов SQL.

Вы можете подумать: «О, еще один язык. Я тут Java с божьей помощью еле-еле понимаю, а вы мне еще один язык сразу предлагаете». 

Это не так: SQL был придуман как язык-спецификация для СУБД так, чтобы писать на этом языке могли бухгалтеры, которые очень далеки от баз данных и программирования в целом. Это значит, что выучить его будет не так уж и сложно. Главное — ПРАКТИКА-ПРАКТИКА-ПРАКТИКА. 

Сегодня будет теория, но следующая статья будет о практике. Так как реляционная база данных — это набор двумерных-массивов-таблиц и отношения между ними, то и работа будет идти вокруг них. 

Если говорить о примере, то можно показать две таблицы — «Страны» и «Города» и как они связаны.<img data-max-width="512" data-id="1fa24117-1787-4c18-818e-4c3163faa95d" src="/images/article/1fa24117-1787-4c18-818e-4c3163faa95d/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 4">Для нас на данном этапе важно понять, что записи в таблице — это данные о каком-то объекте из Java-мира. Например, эти две таблицы через Java можно описать так:

<pre class="lang-java line-numbers"><code>
public class Country {
   private Long id;
   private String name;
}

public class City {

   private Long id;
   private String name;
   private Country country;
   private Integer population;
}
</code></pre>
Ну не красота ли, а? 

В базе данных может храниться сколько угодно таблиц. В нашем случае их две.<h2>Структура таблицы</h2>Я думаю, что все так или иначе сталкивались с excel-таблицами, и вам понятны термины <span class="text-bold">строка</span> и <span class="text-bold">столбец</span>.

В рамках баз данных мы больше говорим о записях и полях:<img data-max-width="512" data-id="1a8fef0a-353b-4f16-a8fd-9819dcb03712" src="/images/article/1a8fef0a-353b-4f16-a8fd-9819dcb03712/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 5">Таким образом получается, что каждый объект класса City — это запись в таблице в базе данных.<h2>Первичный ключ</h2><img data-max-width="512" data-id="f58a3471-54fd-4fe8-a6d4-519fe324ed00" src="/images/article/f58a3471-54fd-4fe8-a6d4-519fe324ed00/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 6">Часто бывает так, что поля в базах данных имеют одинаковые значения. Например, соцсети, где по имени, фамилии и даже отчеству может найтись более одного человека. А реляционные базы данных требуют наличия уникального поля, по которому можно было бы получить доступ к записи.

Вот это и называется первый ключ или Primary Key. Обычно в качестве такого ключа используют поле ID(id) — это сокращение от identifier. Именно поэтому в каждую таблицу нужно добавить поле <span class="text-bold">ID</span>.<img data-max-width="512" data-id="5c93584c-3f61-4f6d-94e7-4145ea6679d0" src="/images/article/5c93584c-3f61-4f6d-94e7-4145ea6679d0/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 7"><h2>Внешний ключ</h2>В нашем примере такое поле есть в таблице City, которая использует ключ от Country. И работает это так: каждый город знает уникальный идентификатор информации по своей стране, и если взять его и создать запрос в БД, мы получим исчерпывающую информацию о стране. 

Как видно на картинке, есть связь (relation) между двумя таблицами:<img data-max-width="512" data-id="c71c8084-2a78-41df-a397-b6d94e55d1ab" src="/images/article/c71c8084-2a78-41df-a397-b6d94e55d1ab/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 8">Здесь показан принцип внешнего ключа.<h2>Какие разделы есть в SQL</h2>На собеседованиях, кстати, часто спрашивают, какие операции есть в SQL:<ul>
<li>DDL (Data Definition Language) — группа операторов, изменяющих/создающих таблицы, их структуру и другое. То есть создание таблицы, ее удаление, создание/удаление полей в таблицах; создание нового первичного ключа и так далее;</li>
<li>DML (Data Manipulation Language) — группа операторов, управляющих изменением данных. Это все операции, которые изменяют данные в БД: добавление, получение, изменение и удаление;</li>
<li>DCL (Data Control Language) — средства подтверждения прав пользователя на выполнение действий. Операции по предоставлению доступа и прав для конкретного пользователя, чтобы он мог выполнять DDL/DML операции.</li>
</ul><a href="https://javarush.com/welcome" target="_blank"><img id="click_banner4_1_articles" data-max-width="1080" data-id="4d8a59b8-3b5b-480a-b034-328940cc2886" src="/images/article/4d8a59b8-3b5b-480a-b034-328940cc2886/1080.jpeg" alt="“"></a><h2>Какие типы данных есть в SQL</h2>Таблицы могут хранить и обрабатывать определенные типы данных. Здесь будет все похоже на то, что мы используем в Java. 

Поговорим об основных. Их всего три, другие уже будем добавлять по необходимости и/или по желанию:<img data-max-width="512" data-id="2781e8e1-b13d-4082-8f43-fad7021b1fb8" src="/images/article/2781e8e1-b13d-4082-8f43-fad7021b1fb8/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 9">Как видно из картинки, это:<ul>
<li><span class="text-bold">INT</span> — целочисленные значения. Используются для уникального идентификатора и для просто целого числа;</li>
<li><span class="text-bold">VARCHAR</span> — это наш <span class="text-bold">String</span>;</li>
<li><span class="text-bold">DATE</span> —  это наш LocalDate.</li>
</ul>Пока что все просто, да? Типы полей задаются при создании таблицы. Ясно, что нельзя будет записать в поле значение другого типа.<h2>Кто такие SQL операторы</h2>Оператор —  это отдельная команда, которая производит какое-то действие. 

Операторы состоят из предложений, те, в свою очередь, из ключевых слов, которые используются в запросах.

Посмотрим на пример:<img data-max-width="512" data-id="987795e8-470d-47d9-9574-a1ec6e01c249" src="/images/article/987795e8-470d-47d9-9574-a1ec6e01c249/512.jpeg" alt="“Java-проект от А до Я”: разбираем базы данных и язык SQL - 10">Здесь уже интереснее, здесь уже построен запрос. Что там делают? Все просто, там говорится: “Взять три поля (Name, Age и CreatedDate) из таблицы Clients, выбрать только те записи, где name равно Roman”.<h2>Вывод</h2>В этой статье мы начали изучать базы данных. Мы поняли, что это такое и зачем оно нам. Далее пробежались по первым признакам SQL, о которых более детально поговорим уже в следующей статье. 

Традиционно предлагаю зарегистрироваться на GitHub и подписаться на <a href="https://github.com/romankh3" rel="nofollow" target="_blank">мой аккаунт</a>, чтобы следить за этой серией и другими моими проектами, которые я веду там.<h2>Домашнее задание</h2>Чтобы добавить интереса к этой серии статей на JRTB, время от времени будут домашние задания. Например, без сегодняшнего задания следующую статью уже будет значительно сложнее понять, ведь там будет много практики.

Поэтому задание: установить СУБД MySQL себе на компьютер и войти в базу данных или через консоль, или через другие решения.

Всем спасибо за прочтение, до скорых встреч!

<h4><a href="https://javarush.com/groups/posts/2935-java-proekt-ot-a-do-ja-pishem-realjhnihy-proekt-dlja-portfolio#articles" target="_blank">Список всех материалов серии в начале этой статьи.</a></h4>
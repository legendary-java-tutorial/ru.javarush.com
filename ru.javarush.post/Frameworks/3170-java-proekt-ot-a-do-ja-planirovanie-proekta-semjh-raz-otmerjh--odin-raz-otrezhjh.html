Планирование проекта: семь раз отмерь — один раз отрежь - "Java-проект от А до Я"
<p>----------------------------------------</p>
Приветствую вас, коллеги. Сегодня мы поговорим о том, какую подготовительную работу нужно провести, прежде чем начать безудержно кодить. А конкретнее — о планировании, создании архитектуры...
<p>----------------------------------------</p>
Приветствую вас, коллеги. Сегодня мы поговорим о том, какую подготовительную работу нужно провести, прежде чем начать безудержно кодить. А конкретнее — о планировании, создании архитектуры приложения.

<img data-max-width="800" data-id="40db04b4-b434-4533-9af1-466a02d20412" src="https://cdn.javarush.com/images/article/40db04b4-b434-4533-9af1-466a02d20412/800.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 1">Но с чего начать? Как построить эту архитектуру? Как и водится во всем, нужно начать с начала. А именно — с ИДЕИ.

Идеей нашего проекта было создание полезного телеграм-бота с базовым функционалом. Повторим, каким именно:

<em><span class="text-bold">“Я, как пользователь, хочу иметь возможность получать уведомления, когда будут выходить новые статьи в тех группах на JavaRush, которые меня интересуют.”</span></em>

Следуя YAGNI принципу, будем строить наше приложение. Это значит, что мы будем брать только то, что нам нужно. Мы не будем создавать функционал наперед и про запас только потому, что нам так хочется и когда-то это может реально пригодиться. 

Да, мы будем создавать удобочитаемое и расширяемое приложение, но это не значит, что мы сделаем схему базы данных “на вырост”. Чтобы этот “вырост” не поддерживать, я решил, что лучше будет вовсе отказаться от него. Это нам поможет избежать излишней поддержки во время разработки и излишнего тестирования. 

Позже, когда  наш проект выйдет в прод (опять англицизм, от сокращения prod — production), мы уже сможем что-то сделать большее.

Как только определились с идеей, нужно немного <s>пошалить</s> порисовать. А что рисовать?

Нам понадобится возможность сохранять данные по подпискам на группы разных пользователей. Я знаю, что можно использовать идентификатор пользователей в виде IDшника чата в телеграме. И есть идея, как собственно будет проходить поиск новых статей: будем искать во всех группах, на которые есть подписки, новые статьи и отправлять их в чаты. Исходя из этого, получим в первом приближении такое (вот вам разработка без прикрас):<img data-max-width="512" data-id="a0c44786-1795-4cfa-a282-43c096626839" src="https://cdn.javarush.com/images/article/a0c44786-1795-4cfa-a282-43c096626839/512.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 2">Я не надеюсь, что вы разберетесь в моем почерке: я хочу показать, как именно и с чего начинается разработка.

Первый этап пройден: определились кое-как с тем, что будет. Сверху описаны модели/таблицы в базе данных. 

Но это черновой вариант: его можно и нужно отшлифовать и привести в более читаемый вид. Пока шлифовал, вспомнил, что хочется еще получать статистику по работе бота. Добавил это. В этом рисунке более чем видно, что и как будет устроено. То есть, какие будут таблицы и поля в них, какие будут имена сущностей для таблиц. 

Решено, что их будет несколько:<ul>
<li>User — информация о пользователе телеграма, который будет использовать нашего бота. Как вы видите, мы сохраняем только айдишник чата и флаг, активный пользователь или нет. Почему? Потому что наша цель — не собрать информацию о пользователях, а принести им пользу;</li>
<li>GroupSub — здесь будет информация о группе, на которую есть подписка и последняя статья, которая была отправлена подписчикам;</li>
<li>Statistics — для нее не создал схему — сделаем это позже. Это не главная цель в MVP проекта.</li>
</ul><img data-max-width="512" data-id="c89e7d46-4d7a-4587-927c-8e93da6ac8ca" src="https://cdn.javarush.com/images/article/c89e7d46-4d7a-4587-927c-8e93da6ac8ca/512.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 3">После этого захотелось уже более детально показать путь поиска новых статей. Для этого я воспользовался BPMN схемой, которую перевел в картинку и получил вот такое:<img data-max-width="1080" data-id="c7b1f4ec-3364-4fc0-aed6-818ac1af3a39" src="https://cdn.javarush.com/images/article/c7b1f4ec-3364-4fc0-aed6-818ac1af3a39/1080.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 4">Здесь уже все более читабельное и понятное. По этой схеме будем работать в поиске. Такую схему очень любят менеджеры, потому что она понятна не только программистам :D

В общем и целом, начало положено.<h2>Создаем репозиторий для работы</h2>Наконец-то можно создать репозиторий уже для работы с телеграм-ботом.<img data-max-width="800" data-id="6c035019-bf6e-48c6-ac2a-329e0503cb84" src="https://cdn.javarush.com/images/article/6c035019-bf6e-48c6-ac2a-329e0503cb84/800.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 5"><ol>
<li>Заполняем уже привычные для нас пункты — имя репозитория, его краткое описание. </li>
<li>Добавляем лицензию — Apache 2.0 (вы можете выбирать лицензию по своему усмотрению). </li>
<li>Наш проект теперь доступен — вот ссылка на него: <a href="https://github.com/javarushcommunity/javarush-telegrambot" rel="nofollow" target="_blank">JavaRush Telegrambot</a>.</li>
</ol><h2>Создаем проект в репозитории</h2>Для работы с проектом хорошо бы использовать инструменты GitHub’a, такие как проект. Что это такое? Это место, в рамках которого можно будет создавать задачи, отслеживать их выполнение, сохранять статус задачи. Определять, кто будет выполнять их и другое. Для этого в созданном проекте найдем кнопку <span class="text-bold">Projects</span>, и там уже создадим новый:<img data-max-width="800" data-id="5117249b-6785-4d77-8ea3-b3158a4be848" src="https://cdn.javarush.com/images/article/5117249b-6785-4d77-8ea3-b3158a4be848/800.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 6">Как видим, здесь я указал имя проекта, описал его и выбрал шаблон, по которому будем работать — Automated Kanban. Для нас сейчас не так уж важно, что это значит. Главное, что у нас будет доска с задачами, поделенная на колонки, где каждая из колонок будет статусом задачи:<ol>
<li>To do — все задачи, которые планируется сделать;</li>
<li>In progress — задачи, над которыми идет работа в данный момент;</li>
<li>Done — задачи, которые уже сделаны в рамках этого проекта. </li>

</ol>Таким образом мы будем знать о статусе наших задач. Какие в работе, какие сделаны.

Причем это важно и удобно не только в случаях, когда есть команда, но и когда работаешь сам.

Чтобы на доске что-то появилось, нужно создать задачи (Issue).<h2>Пишем задачи (issue) для проекта</h2>Чтобы понять, какие задачи писать, определимся с тем, что у нас будет в проекте.

Нам нужно приложение, которое можно было бы запустить легко и быстро, чтобы был доступ к базе данных, чтобы мы могли управлять схемой базы данных и изменять ее, чтобы можно было делать REST запросы в JavaRush для получения данных по статьям. 

Исходя из этого, можно выбрать следующие технологии:<ul>
<li>SpringBoot — как каркас для нашего приложения,</li>
<li>Spring Data — для работы с базой данных,</li>
<li>Flyway — для работы с миграциями базы данных,</li>
<li>MySQL — как БД для проекта,</li>
<li>Telegrambot StringBoot starter — библиотека для работы с телеграм-ботом,</li>
<li>Unirest — библиотека для работы с REST запросами.</li>

</ul>Из всего вышеперечисленного начнем создавать задачи.<h3>Шаблон создания задач</h3>Будем создавать задачи по следующему шаблону:<ol>

<li>Имя задачи будет иметь такой вид: <span class="text-bold">JRTB-{IssueNumber}:{IssueDescription}</span>, где:<ul>
<li>{IssueNumber} — это порядковый номер задачи. Берем его на один больше от последней задачи;</li>
<li>{IssueDescription} — краткое описание задачи.</li></ul>
</li><li>В теле задачи будем делать ее более детальное описание (иногда может совпадать с описанием в имени задачи).</li>
<li>Acceptance Criteria — это перечень требований, после выполнения которых можно считать, что задача выполнена. Так сказать, критерии приемки задачи. По ним ревьювер (от англ. reviewer — рецензент — человек, который смотрит как выполнена задача) может понять, полностью ли сделана задача или нет. </li>

</ol>По этому шаблону создадим наше первое задание:<img data-max-width="1024" data-id="070e2b4e-9a72-4f97-a847-28b0a1eb5fe3" src="https://cdn.javarush.com/images/article/070e2b4e-9a72-4f97-a847-28b0a1eb5fe3/1024.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 7">Также стоит обратить внимание, что при создании я сразу определил, к какому проекту подходит эта задача, кто ее будет выполнять (assignee) и к какой метке (label) эта задача относится. 

Далее я просто покажу имена задач с небольшим описанием и ссылки на них. Все они находятся <a href="https://github.com/javarushcommunity/javarush-telegrambot/issues" rel="nofollow" target="_blank">здесь</a>.

Выполнять задачи мы будем примерно в том же порядке, что здесь указан:<ol>

<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/12" rel="nofollow" target="_blank">[FEATURE] JRTB-0: create Skeleton Spring boot project</a> — здесь все понятно: нужно сделать первую часть того, что мы делали в предыдущей статье.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/2" rel="nofollow" target="_blank">[FEATURE] JRTB-2: add telegram bot to the project</a> — добавляем пустого бота, который будет просто отвечать и говорить, что он жив-здоров.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/3" rel="nofollow" target="_blank">[FEATURE] JRTB-3: Implement Command pattern for telegrambot</a> — настроим правильный подход к работе с командами в телеграм-боте. Пока что для нескольких команд.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/1" rel="nofollow" target="_blank">[FEATURE] JRTB-1: Add repository layer</a> — это одна из самых больших задач — здесь объединено все то, что нужно сделать для работы с базой данных. </li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/5" rel="nofollow" target="_blank">[FEATURE] JRTB-5: As a user, I want to add the group to the subscription</a> — это уже первая User Story в понимании Agile. Здесь уже будет реальный выхлоп для наших пользователей: можно будет добавлять подписки на группы в бота. </li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/13" rel="nofollow" target="_blank">[FEATURE] JRTB-12: Implement scheduling for sending notification about new articles</a> — вот здесь будет реализация поиска новых статей, если они вышли для каждой из групп и отправлены всем пользователям, которые подписаны на группы.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/6" rel="nofollow" target="_blank">[FEATURE] JRTB-6: As a user, I want to see list of my group subscriptions</a> — здесь все просто: добавляем команду с выводом списка всех групп, на которые подписан пользователь.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/7" rel="nofollow" target="_blank">[FEATURE] JRTB-7: As a User, I want to remove group subscription from my subscriptions</a> — здесь нужно реализовать удаление подписки пользователя на обновления в группе.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/8" rel="nofollow" target="_blank">[FEATURE] JRTB-8: As a User, I want to set inactive using bot</a> — реализовать остановку бота. То есть все то, что нужно сделать в нашей системе, чтобы работа остановилась. Добавить в обработку команду /stop.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/9" rel="nofollow" target="_blank">[FEATURE] JRTB-9: As a User, I want to start working with bot OR set active if I used it before</a> — добавить обработку команды /start. Именно так, как мы хотим этого.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/10" rel="nofollow" target="_blank">[FEATURE] JRTB-10: As an administrator, I want to see bot statistics</a> — создание сбора статистики бота. Добавление возможности администраторов.</li>
<li><a href="https://github.com/javarushcommunity/javarush-telegrambot/issues/11" rel="nofollow" target="_blank">[FEATURE] JRTB-11: As a user, I want to see documentation for this telegram bot</a> — написание документации. Да-да, друзья, без нее никуда, и чем раньше вы научитесь это делать, тем лучше будет для вас))</li>
 
</ol>Вот это уже похоже на начало проекта. Так сказать, поработали мы архитектором проекта и бизнес-аналитиком.<h2>Заполняем репозиторий</h2>Что нужно еще сделать ДО того, как мы начнем кодить?

<em>— Автор, ну сколько можно добавлять этих абзацев, ты что их, из бездны достаешь??
— Нет, качество работы проявляется в деталях. И именно они имеют смысл. </em>

Поэтому добавим еще одну деталь. Чтобы проект стал популярным и понятным для других разработчиков, нужно наполнить его. Что нужно добавить? Полный перечень того, что можно сделать, я описал в статье <a href="https://javarush.com/groups/posts/2478-optimiziruem-rabotu-so-svoimi-proektami-na-github-znakomstvo-s-github-template-repository" target="_blank">Оптимизируем работу со своими проектами на GitHub: знакомство с Github Template Repository</a>. Очень советую прочитать. Для нас важно иметь четкое версионирование, четкое понимание того, что мы делаем. 

Поэтому я добавил RELEASE_NOTES файл, в котором будут записываться изменения по нашему проекту. В качестве примера можно посмотреть на <a href="https://github.com/romankh3/image-comparison/blob/master/RELEASE_NOTES.md" rel="nofollow" target="_blank">RELEASE_NOTES из моего проекта</a> (да, почему бы не показать то, во что я вкладываю свои силы и творчество). Там описаны изменения по каждой новой версии.

Также добавил шаблоны для создания новых задач, в которых есть 4 варианта:<ul>

<li><span class="text-bold">Bug Report</span> задача, которую создают пользователи/тестировщики, нашедшие ошибку в работе. Это очень важная вещь: она помогает управлять исправлением ошибок;</li>
<li><span class="text-bold">Feature request</span> — это задача на добавление новой функциональности. Все первые задачи на проекте — задачи на feature request;</li>
<li><span class="text-bold">Improvement request</span> — задача на улучшение работы приложения. Например, на изменение тестовых ответов в работе с ботом. Я не technical writer и могу придумать не совсем правильные ответы. Так если будет желание и умение — предлагайте :) </li>
<li><span class="text-bold">Question</span> — это вопрос к разработчикам по работе приложения. Очень полезная вещь. Допустим, нет понимания в работе или есть сомнения в каком-то вопросе — можно задать таким образом вопрос и получить ответ из первых рук. </li>

</ul>Если посмотреть на гитхаб, то это будет выглядеть именно так:<img data-max-width="1080" data-id="4e470739-6d36-43b3-bd9a-db6fe872189a" src="https://cdn.javarush.com/images/article/4e470739-6d36-43b3-bd9a-db6fe872189a/1080.jpeg" alt="Java-проект от А до Я. Планирование проекта: семь раз отмерь — один раз отрежь - 8">Также на данный момент мы располагаем документом по работе с JavaRush API для работы с группами. <h2>Что дальше?</h2>Ну вот выполним мы все эти шаги и что, проект закроется?

Нет, вовсе нет. Этот проект будет жить и дальше. Его буду развивать я и все те ученики/выпускники JavaRush, которые захотят принять участие. 

Какие планы на будущее? Их много. Самый первый план — это создание Java-клиента для JavaRush API. Разработчики пообещали сделать открытый доступ к их Swagger’у. Что такое сваггер мы тоже разберем. Прикольная и очень полезная вещь. 

Дальше будем интегрировать JavaRush сайт с телеграм-ботом. Подключим пользователя к боту, чтобы синхронизировать подписки. Создадим статистику по прохождению курса. 

И все, что вы захотите как JavaRush Community.<h2>Выводы</h2>Сегодня мы поговорили о закулисной работе до создания проекта. А точнее, о том, как создать план работы, без которого можно потратить много энергии впустую.

Повторю, начало проекта уже выложено в открытый доступ <a href="https://github.com/javarushcommunity/javarush-telegrambot" rel="nofollow" target="_blank">здесь</a>. 

Традиционно предлагаю подписаться на <a href="https://github.com/romankh3" rel="nofollow" target="_blank">мой аккаунт</a> на гитхабе. Таким образом вы сможете получить изменения в проекте ДО того, как публикуется статья.

Уже предполагаю, что все заинтересованные лица зарегистрировались на гитхабе. 

Да, проект не летит так быстро, как нам хотелось бы. Впрочем, как и реальные проекты на работе. 

В следующей статье я опишу добавление первых задач.

Всем спасибо за прочтение и до скорого!

<h4><a href="https://javarush.com/groups/posts/2935-java-proekt-ot-a-do-ja-pishem-realjhnihy-proekt-dlja-portfolio#articles" target="_blank">Список всех материалов серии в начале этой статьи.</a></h4>
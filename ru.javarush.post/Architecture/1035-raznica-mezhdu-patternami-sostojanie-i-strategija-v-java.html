Разница между паттернами Состояние и Стратегия в Java
<p>----------------------------------------</p>
Для того, чтобы правильно использовать паттерны Состояние и Стратегия в ядре Java приложений, важно для Java-программистов четко понимать разницу между ними. Хотя оба шаблона, Состояние и Стратегия, имеют схожую структуру, и оба основаны на принципе ...
<p>----------------------------------------</p>
Для того, чтобы правильно использовать паттерны <strong>Состояние</strong> и <strong>Стратегия</strong> в ядре Java приложений, важно для Java-программистов четко понимать разницу между ними. Хотя оба шаблона, Состояние и Стратегия, имеют схожую структуру, и оба основаны на принципе открытости/закрытости, представляющие ”O” в <a href="http://javarevisited.blogspot.com/2012/03/10-object-oriented-design-principles.html" rel="nofollow" >SOLID принципах</a>, они совершенно разные по <em>намерениям</em>.
<img data-id="77ec83f7-ee44-4010-aab3-2f3357adb723" data-max-width="850" alt="Разница между паттернами Состояние и Стратегия в Java - 1" src="https://cdn.javarush.com/images/article/77ec83f7-ee44-4010-aab3-2f3357adb723/1024.jpeg">Паттерн <strong>Стратегия</strong> в Java <em>используется для инкапсуляции</em> связанных наборов алгоритмов для обеспечения гибкости исполнения для клиента. Клиент может выбрать любой алгоритм во время выполнения без изменения контекста класса, который использует объект <code>Strategy</code>. 

Некоторые популярные примеры паттерна <strong>Стратегия</strong> – это написание кода, который использует алгоритмы, например, шифрование, сжатие или сортировки. С другой стороны, паттерн Состояние позволяет объекту вести себя по-разному в разном состоянии. Поскольку в реальном мире объект часто имеет состояния, и он ведет себя по-разному в разных состояниях, например, торговый автомат продает товары только если он в состоянии <code>hasCoin</code>, он не продает до тех пор пока вы не положите в него монету. Сейчас вы можете ясно видеть разницу между паттернами Стратегия и Состояние, это различные намерения. <a href="http://java67.blogspot.sg/2012/09/top-10-java-design-pattern-interview-question-answer.html" rel="nofollow" >Паттерн Состояние</a> помогает объекту управлять состоянием, тогда как паттерн Стратегия позволяет выбрать клиенту другое поведение. 

Еще одно отличие, которое не так легко увидеть, это кто управляет изменением в поведении. В случае паттерна Стратегия, это клиент, который предоставляет различные стратегии к контексту, в паттерне Состояние переходом управляет контекст или состояние объекта самостоятельно. Кроме того, если вы управляете изменениями состояний в объекте Состояние самостоятельно, должна быть ссылка на контекст, например, в торговом автомате должна быть возможность вызвать метод <code>setState()</code> для изменения текущего состояния контекста. С другой стороны, объект Стратегия никогда не содержит ссылку на контекст, сам клиент передает Стратегию своего выбора в контекст. Разница между паттернами Состояние и Стратегия один из <a href="http://javarevisited.blogspot.sg/2012/06/20-design-pattern-and-software-design.html" rel="nofollow" >популярных вопросов о паттернах Java на интервью</a>, в этой статье о паттернах Java мы подробней рассмотрим это. Мы будем исследовать некоторые сходства и различия между паттернами Стратегия и Состояние в Java, которые помогут вам улучшить ваше понимание этих паттернов.

<h2>Сходства между паттернами Состояние и Стратегия</h2>Если вы посмотрите на UML-диаграмму паттернов Состояние и Стратегия, можно заметить, что оба выглядят похоже друг на друга. Объект, который использует Состояние для изменения своего поведения известен как <code>Context</code>-объект, аналогично объект, который использует Стратегию чтобы изменить свое поведение упоминается как <code>Context</code>-объект. Запомните, что клиент взаимодействует с <code>Context</code>-объектом. В случае паттерна Состояние контекст делегирует методы вызова объекту Состояние, который удерживается в виде текущего объекта, а в случае паттерна Стратегия контекст использует объект Стратегии в качестве параметра или предоставляется во время создания контекста объекта.

<em>UML диаграмма паттерна Состояние в Java</em>
<img data-id="860d8aa3-4234-40e4-bbd3-e8245e68c06e" data-max-width="1016" alt="Разница между паттернами Состояние и Стратегия в Java - 2" src="https://cdn.javarush.com/images/article/860d8aa3-4234-40e4-bbd3-e8245e68c06e/1024.jpeg">Эта UML диаграмма для паттерна Состояние, изображает классическую проблему создания объектно-ориентированного дизайна торгового аппарата в Java. Вы можете видеть, что состояние торгового аппарата представлено с использованием интерфейса, который далее имеет реализацию для представления конкретного состояния. Каждое состояние также имеет ссылки на контекст объекта, чтобы сделать переход в другое состояние в результате действий вызванных в контексте.

<em>UML диаграмма паттерна Стратегия в Java</em>
<img data-id="9cea0830-1212-4ab7-9b8e-fdc94bee1ca1" data-max-width="1098" alt="Разница между паттернами Состояние и Стратегия в Java - 3" src="https://cdn.javarush.com/images/article/9cea0830-1212-4ab7-9b8e-fdc94bee1ca1/1024.jpeg">Эта UML диаграмма для паттерна Стратегия содержит функциональные реализации сортировок. Поскольку есть много алгоритмов сортировки, этот шаблон проектирования позволяет клиенту выбрать алгоритм при сортировке объектов. На самом деле <em>Java Collection framework</em> использует этот паттерн реализуя метод <code>Collections.sort()</code>, который используется для сортировки объектов в Java. Единственная разница в том, что вместо разрешения клиенту выбирать алгоритм сортировки он позволяет ему указать стратегию сравнения передавая экземпляр <a href="http://javarevisited.blogspot.sg/2011/06/comparator-and-comparable-in-java.html" rel="nofollow" >интерфейса Comparator или Comparable в Java</a>.

Давайте посмотрим на несколько сходств между этими двумя основными шаблонами проектирования в Java:
<ol>
<li>Оба паттерна, Состояние и Стратегия, делают несложным добавление нового состояния и стратегии не затрагивая контекст объекта, который использует их.</li><br />
<li>Оба из них поддерживают ваш код в соответствии с <a href="http://javarevisited.blogspot.sg/2011/11/great-example-of-open-closed-design.html" rel="nofollow" >принципом открытости/закрытости</a>, то есть дизайн будет открыт для расширений, но закрыт для модификации. В случае паттернов Состояние и Стратегия, контекст объекта закрыт для модификаций, введений новых Состояний или новых Стратегий, либо вы не нуждаетесь в модификации контекста другого состояния, или минимальных изменениях.</li><br />
<li>Также как контекст объекта начинается с состояния инициализации объекта в паттерне Состояние, контекст объекта также имеет стратегию по умолчанию в случае паттерна Стратегия в Java.</li><br />
<li>Паттерн Состояние представляет различные поведения в форме различных состояний объекта, в то время как паттерн Стратегия представляет различное поведение в виде различных стратегий объекта.</li><br />
<li>Оба паттерна, Стратегия и Состояние, зависят от подклассов реализации поведения. Каждая конкретная стратегия расширяет Абстрактную Стратегию, каждое состояние есть подкласс <a href="http://javarevisited.blogspot.sg/2013/05/difference-between-abstract-class-vs-interface-java-when-prefer-over-design-oops.html" rel="nofollow" >интерфейса или абстрактного класса</a>, который используется для преставления Состояния.</li></ol><h2>Различия между паттернами Стратегия и Состояние в Java</h2>Итак, теперь мы знаем, что паттерны Состояние и Стратегия похожи по структуре, а их намерения различны. Давайте рассмотрим некоторые ключевые различия между этими шаблонами проектирования.
<ol>
<li>Паттерн Стратегия инкапсулирует набор связанных алгоритмов, и позволяет клиенту использовать взаимозаменяемые поведения несмотря на состав и делегирование во время выполнения, с другой стороны паттерн Состояние помогает классу демонстрировать различные поведения в различных состояниях.</li><br />
<li>Следующая разница между паттернами Состояние и Стратегия состоит в том, что Состояние <a href="http://javarevisited.blogspot.sg/2012/03/what-is-encapsulation-in-java-and-oops.html" rel="nofollow" >инкапсулирует</a> состояние объекта, тогда как паттерн Стратегия инкапсулирует алгоритм или стратегию. Поскольку состояние связано с объектом оно не может быть повторно использовано, но отделяя стратегию или алгоритм из контекста мы можем использовать его повторно.</li><br />
<li>В паттерне Состояние личное состояние может содержать ссылку на контекст для реализации переходов между состояниями, но Стратегия не содержит ссылку на контекст где она используется.</li><br />
<li>Реализация Стратегии может быть передана как параметр объекту, который будет использовать ее, например, Collection.sort() принимает <a href="http://javarevisited.blogspot.sg/2014/01/java-comparator-example-for-custom.html" rel="nofollow" >Comparator</a>, который является стратегией. С другой стороны, состояние является частью самого контекста объекта, и в течение долгого времени контекст объекта переходит из одного состояния в другое.</li><br />
<li>Хотя и Стратегия и Состояние следуют принципу открытости/закрытости, Стратегия также следует Принципу Единственной Обязанности так как каждая Стратегия содержит индивидуальный алгоритм, различные стратегии независимы друг от друга. Изменение одной стратегии не требует изменения другой стратегии.</li><br />
<li>Еще одно теоретическое отличие между паттернами Стратегия и Состояние заключается в том, что создатель определяет часть объекта “Как”, например, “Как” объект сортировки сортирует данные, с другой стороны паттерн Состояние определяет части “что” и “когда” в объекте, например, что может объект когда он находится в определенном состоянии.</li><br />
<li>Порядок перехода состояния хорошо определен в паттерне Состояние, такого требования нет к паттерну Стратегия. Клиент волен в выборе любой реализации Стратегии на его выбор.</li><br />
<li>Некоторые из общих примеров паттерна Стратегия – это инкапсуляция алгоритмов, например, алгоритмы сортировки, шифрования или алгоритм сжатия. Если вы видите, что ваш код должен использовать различные виды связанных алгоритмов, следует подумать об использовании паттерна Стратегия. С другой стороны, распознать возможность использования паттерна Состояние довольно легко, если вам нужно управлять состоянием и переходами между состояниями без большого количества вложенных условных операторов паттерн Состояние – нужный паттерн для использования.</li><br />
<li>Последнее, но одно из наиболее важных различий между паттернами Состояние и Стратегия заключается в том, что изменение Стратегии выполняется Клиентом, а изменение Состояния может быть выполнено контекстом или состоянием объекта самостоятельно.</li><br />
</ol>Это все про <strong>разницу между паттернами Состояние и Стратегия в Java</strong>. Как я сказал, оба выглядят похоже в своих классах и UML диаграммах, оба обеспечивают открыто/закрытый принцип и инкапсулируют поведение. Используйте паттерн Стратегия для инкапсулирования алгоритма или стратегии, который предоставляется контексту во время выполнения, возможно как параметр или составной объект и используйте паттерн Состояние для управления переходами между состояниями в Java.

Оригинал <a href="http://javarevisited.blogspot.sg/2014/04/difference-between-state-and-strategy-design-pattern-java.html" rel="nofollow" >здесь</a>
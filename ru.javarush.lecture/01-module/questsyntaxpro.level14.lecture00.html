Правильная работа программы
<p>----------------------------------------</p>
Задачи программиста  Очень часто начинающие программисты представляют себе суть работы программиста совсем не так, как опытные программисты. От новичка часто можно услышать «Программа работает, что вам еще нужно?» Опытный же программист знает, что «работает правильно» – это только одно из требов
<p>----------------------------------------</p>
<h2>1. Задачи программиста</h2>
<p><img data-id="ca2c2d09-f7e9-48ff-a2f6-263cc39c12c3" data-max-width="856" alt="" src="https://cdn.javarush.com/images/article/ca2c2d09-f7e9-48ff-a2f6-263cc39c12c3/original.png"></p>
<p>Очень часто <span class="text-red">начинающие программисты</span> представляют себе суть работы программиста совсем не так, как <span class="text-green">опытные программисты</span>.</p>
<p>От новичка часто можно услышать «Программа работает, что вам еще нужно?». Опытный же программист знает, что «работает правильно» — это только <span class="text-orange">одно из требований к программе</span>, причем даже <span class="text-red">не самое главное</span>!</p>
<p><strong>Читабельность кода</strong></p>
<p>Самое главное — это чтобы <span class="text-green">код программы был понятен другим программистам</span>. Это <span class="text-red">важнее, чем правильно работающая программа. </span>Гораздо важнее.</p>
<p>Если у вас есть неправильно работающая программа, вы можете ее исправить, а если у вас есть программа, код которой непонятен, вы ничего не можете с ней сделать.</p>
<p>Просто возьмите любую скомпилированную программу, например, notepad (блокнот) и поменяйте у него цвет фона на красный. Работающая программа у вас есть, понятного кода программы у вас нет: в такую программу невозможно вносить изменения.</p>
<p>Хрестоматийный пример — когда разработчики Microsoft убрали из Windows игру Pinball, потому что не смогли портировать ее на 64-х разрядную архитектуру. Причем у них даже были ее исходники. Просто они <a href="https://habr.com/ru/post/163105/">не могли понять</a>, как работает написанный код.</p>
<p><strong>Учет всех сценариев использования</strong></p>
<p>Второе по важности требование к программе — это учет всех сценариев ее работы. Зачастую все оказывается немного сложнее, чем кажется.</p>
<p>Как программист-новичок видит отправку СМС в своей программе:</p>
<p><img data-id="058f5f9e-8f18-435a-b763-323b9437bbfe" src="https://cdn.javarush.com/images/article/058f5f9e-8f18-435a-b763-323b9437bbfe/original.png" alt="Правильная работа программы"></p>
<p>Как это видит-программист-профессионал:</p>
<p><img data-id="915bd526-7ab4-442e-80ad-c8de9e75e63a" src="https://cdn.javarush.com/images/article/915bd526-7ab4-442e-80ad-c8de9e75e63a/original.png" alt="Правильная работа программы"></p>
<p>А «работа правильно» — это обычно только один из множества сценариев. И именно поэтому многие новички жалуются на валидатор задач в JavaRush: один сценарий из 10 работает, и программист-новичок думает, что этого достаточно.</p>
<hr>
<h2>2. Нештатные ситуации</h2>
<p><img data-id="31d3ab35-e07d-483d-9152-852ed4731d6a" src="https://cdn.javarush.com/images/article/31d3ab35-e07d-483d-9152-852ed4731d6a/original.png" alt="Нештатные ситуации"></p>
<p>При работе любой программы могут возникать нештатные ситуации.</p>
<p>Например, вы решили сохранить файл, а на диске нет места. Или программа пытается записать данные в память, а памяти мало. Или вы скачиваете картинку из интернета, а в процессе скачивания пропала связь.</p>
<p>Программист (автор программы) должен каждую нештатную ситуацию а) <span class="text-red">предугадать</span>, б) <span class="text-red">решить, как именно программа должна работать в этой ситуации</span>, в) <span class="text-green">запрограммировать решение, максимально близкое к желаемому.</span></p>
<p>Поэтому довольно долго у программ было очень простое поведение: <span class="text-red">если в программе происходила ошибка, программа закрывалась.</span> И это был достаточно хороший подход.</p>
<p>Допустим, вы хотите сохранить документ на диск, и в процессе сохранения выясняется, что места на диске не хватает. Какой вариант поведения программы вам бы понравился больше всего:</p>
<ul>
    <li>Программа закрылась</li>
    <li>Программа продолжила работать, но файл не сохранила.</li>
</ul>
<p>Программисту-новичку может показаться, что второй вариант лучше, ведь программа-то работает. Но на самом деле это не так.</p>
<p>Представьте, что вы 3 часа набирали документ в Word’е, хотя еще на второй минуте работы стало ясно, что программа не может сохранить документ на диск. Что лучше — потерять две минуты работы или три часа?</p>
<p><span class="text-green">Если программа не может сделать то, что нужно, лучше пусть она закроется, чем продолжает делать вид, что все в порядке.</span> Лучшее, что может сделать программа в случае сбоя, который не может исправить самостоятельно — тут же уведомить пользователя о проблеме.</p>
<hr>
<h2>3. Предыстория возникновения исключений</h2>
<p>Нештатные ситуации бывают не только у программ, но и внутри программы — у методов. Например:</p>
<ul>
    <li>Метод хочет записать файл на диск, а места нет.</li>
    <li>Метод хочет вызвать функцию у переменной, а переменная == null.</li>
    <li>В методе возникло деление на 0.</li>
</ul>
<p>При этом вызывающий метод возможно мог бы исправить ситуацию (выполнить альтернативный сценарий), если бы знал, какая именно проблема произошла во время работы вызываемого метода.</p>
<p>Если мы пытаемся сохранить файл на диск и такой файл уже существует, можно просто попросить у пользователя подтверждение для перезаписи файла. Если на диске нет места, можно вывести пользователю уведомление и предложить выбрать другой диск. А если у программы закончилась память — аварийно завершится.</p>
<p>Когда-то давно программисты думали над этим вопросом и придумали такое решение: <span class="text-orange">все методы/функции должны возвращать код ошибки в качестве результата своей работы. </span>Если функция отработала отлично, она <span class="text-green">возвращала</span> 0, если нет — возвращала <span class="text-red">код ошибки</span> (не ноль).</p>
<p>При таком подходе к ошибкам программисту после вызова практически каждой функции нужно было добавлять проверку, не завершилась ли функция с ошибкой. Код программ значительно увеличился и стал похож на такое:</p>
<table>
    <tbody>
    <tr>
        <th>Код без обработки ошибок</th>
        <th>Код с обработкой ошибок</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>File <span class="text-user">file</span> = new File("ca:\\note.txt");
<span class="text-user">file</span>.<span class="text-red">writeLine</span>("Текст");
<span class="text-user">file</span>.<span class="text-red">close</span>();</code></pre>
        </td>
        <td>
<pre class="language-java"><code>File <span class="text-user">file</span> = new File("ca:\\note.txt");
int <span class="text-green">status</span> = <span class="text-user">file</span>.<span class="text-red">writeLine</span>("Текст");
if (<span class="text-green">status</span> == 1)
{
   ...
}
else if (<span class="text-green">status</span> == 2)
{
   ...
}
status = <span class="text-user">file</span>.<span class="text-red">close</span>();
if (<span class="text-green">status</span> == 3)
{
   ...
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Кроме того, очень часто функция, которая «видела», что произошла ошибка, не знала, что с ней делать: ошибку нужно было вернуть вызывающей функции, а та возвращала ее своей вызывающей и т.д.</p>
<p><span class="text-orange">В большой программе цепочка из десятков вызовов функций — это норма: иногда даже можно встретить глубину вызова в сотни функций. </span>И вот нужно передать код ошибки с самого низа на самый верх. И если где-то на этом пути какая-то функция не обработает код завершения, ошибка потеряется.</p>
<p>Еще один минус такого подхода в том, что если функции возвращали код ошибки, они больше не могли возвращать значения своей работы. Приходилось передавать результат вычислений через параметры-ссылки. Это делало код еще более громоздким и еще больше увеличивало количество ошибок.</p>
<hr>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task14.task1401"></div>
Приведение типов в Java
<p>----------------------------------------</p>
Приведение типов  Переменные примитивных типов (за исключением типа boolean) используются для хранения разных типов чисел. И хоть типы переменных всегда неизменны, есть место, где можно проводить преобразование типов. И место это –&nbsp;присваивание. Можно присваивать друг другу переменные разны
<p>----------------------------------------</p>
<div class="lesson-carousel lesson-carousel--comics lesson-carousel--desktop">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="d357f103-ce69-4779-8bfd-fe0c8e8109b4" src="https://cdn.javarush.com/images/article/d357f103-ce69-4779-8bfd-fe0c8e8109b4/original.png" alt="">
        </div>
    </div>
</div>
<div class="lesson-carousel lesson-carousel--comics lesson-carousel--mobile">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="13bfd5ac-5165-444e-aaf0-e8036ce62d64" src="https://cdn.javarush.com/images/article/13bfd5ac-5165-444e-aaf0-e8036ce62d64/original.png" alt="">
        </div>
        <div class="lesson-carousel__item">
            <img data-id="f71740d6-5af2-4a28-b28b-fbef4c919b88" src="https://cdn.javarush.com/images/article/f71740d6-5af2-4a28-b28b-fbef4c919b88/original.png" alt="">
        </div>
    </div>
</div>
<hr>
<h2>1. Приведение типов</h2>
<p><img data-id="ea235ad1-60a6-4063-9f51-24c7a82e9ef3" src="https://cdn.javarush.com/images/article/ea235ad1-60a6-4063-9f51-24c7a82e9ef3/original.jpg" alt="Приведение типов в Java"></p>
<p>Переменные примитивных типов (за исключением типа <code>boolean</code>) используются для хранения разных типов чисел. И хоть типы переменных всегда неизменны, есть место, где можно проводить преобразование типов. И место это — <span class="term">присваивание</span>.</p>
<p>Можно присваивать друг другу переменные разных типов. При этом значение, взятое из переменной одного типа, будет преобразовано в значение другого типа и присвоено второй переменной. В связи с этим можно выделить два вида преобразования типов: расширение и сужение.</p>
<p><strong>Расширение типа</strong> похоже на перекладывание из маленькой корзинки в большую — операция проходит незаметно и безболезненно. <strong>Сужение типа</strong> — это перекладывание из большой корзинки в маленькую: места может не хватить, и что-то придётся выбросить.</p>
<p>Вот типы, отсортированные по размеру «корзинки»:</p>
<p><img data-id="5b2f1d28-0785-4131-bb55-854d83346e52" src="https://cdn.javarush.com/images/article/5b2f1d28-0785-4131-bb55-854d83346e52/original.png" alt="Приведение типов в Java 2"></p>
<hr>
<h2>2. Расширение типов</h2>
<p>Часто может возникнуть необходимость присвоить переменной одного числового типа значение переменной другого числового типа. Как же это сделать?</p>
<p>В Java есть 4 целочисленных типа:</p>
<table>
    <tbody>
    <tr>
        <th class="text-center">Тип</th>
        <th class="text-center">Размер</th>
    </tr>
    <tr>
        <td class="text-center"><code>byte</code></td>
        <td class="text-center"><code>1 байт</code></td>
    </tr>
    <tr>
        <td class="text-center"><code>short</code></td>
        <td class="text-center"><code>2 байта</code></td>
    </tr>
    <tr>
        <td class="text-center"><code>int</code></td>
        <td class="text-center"><code>4 байта</code></td>
    </tr>
    <tr>
        <td class="text-center"><code>long</code></td>
        <td class="text-center"><code>8 байт</code></td>
    </tr>
    </tbody>
</table>
<p><span class="text-green">Переменной большего размера всегда можно присваивать переменные меньшего размера.</span></p>
<p>Переменной типа <code>long</code> спокойно можно присваивать переменные типа <code>int</code>, <code>short</code> и <code>byte</code>. Переменной типа <code>int</code> можно присваивать переменные типа <code>short</code> и <code>byte</code>. Ну и переменной типа <code>short</code> можно присваивать переменные типа <code>byte</code>.</p>
<p>Примеры:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte <span class="text-red">a</span> = 5;
short <span class="text-green">b</span> = <span class="text-red">a</span>;
int <span class="text-viola">c</span> = <span class="text-red">a</span> + <span class="text-green">b</span>;
long <span class="text-neon">d</span> = <span class="text-viola">c</span> * <span class="text-viola">c</span>;</code></pre>
        </td>
        <td style="vertical-align: middle">Этот код отлично скомпилируется.</td>
    </tr>
    </tbody>
</table>
<p>Такое преобразование, от типа меньшего размера к большему, называется <span class="term"><span class="text-green">расширением типа</span></span>.</p>
<p><strong>А что насчет вещественных чисел?</strong></p>
<p>С ними все аналогично — размер имеет значение:</p>
<table>
    <tbody>
    <tr>
        <th class="text-center">Тип</th>
        <th class="text-center">Размер</th>
    </tr>
    <tr>
        <td class="text-center"><code>float</code></td>
        <td class="text-center"><code>4 байта</code></td>
    </tr>
    <tr>
        <td class="text-center"><code>double</code></td>
        <td class="text-center"><code>8 байт</code></td>
    </tr>
    </tbody>
</table>
<p>Переменной типа <code>double</code> можно без проблем присвоить переменную типа <code>float</code>. А вот с целочисленными типами интереснее.</p>
<p>Переменной типа <code>float</code> можно присвоить переменную любого целочисленного типа. Даже типа <code>long</code>, длина которого 8&nbsp;байт. А переменной типа <code>double</code> можно присвоить вообще что угодно: переменную любого целочисленного типа и переменную типа <code>float</code>:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Примечание</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>long <span class="text-green">a</span> = 1234567890;
float <span class="text-neon">b</span> = <span class="text-green">a</span>;
double <span class="text-viola">c</span> = <span class="text-green">a</span>;</code></pre>
        </td>
        <td>
                <pre><code>
b == 1.234567<span class="text-red">94</span><span class="text-orange">E9</span>
c == 1.23456789<span class="text-orange">E9</span></code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Обратите внимание, что преобразование к вещественному типу может привести к потере точности из-за нехватки значащих цифр.</p>
<p>При преобразовании из целых чисел в дробные могут отбрасываться самые младшие части числа. Но т.к. смысл дробного числа в том, чтобы хранить приблизительное значение, такое присваивание разрешается.</p>
<hr>
<h2>3. Сужение типов</h2>
<p>А что насчет остальных вариантов? Что делать, если нужно переменной типа <code>int</code> присвоить значение переменной типа <code>long</code>?</p>
<p>Представьте, что переменная — это корзина. У нас есть корзины разных размеров: 1, 2, 4 и 8 байт. При перекладывании пирожков из меньшей корзины в большую проблем не будет. А вот при перекладывании из большей в меньшую часть пирожков может потеряться.</p>
<p>Это преобразование — от типа большего размера к меньшему — называют <span class="term"><span class="text-red">сужением типа</span></span>. При таком присваивании часть числа может просто не поместиться в новую переменную и «остаться за бортом».</p>
<p>При сужении типа мы должны явно показать компилятору, что мы не ошиблись, и отбрасывание части числа сделано осознанно. Для этого используется оператор приведения типа. Это <strong>имя типа в круглых скобочках</strong>.</p>
<p>В таких ситуациях <span class="term">Java-компилятор</span> требует от программиста указывать оператор преобразования типа. Выглядит в общем виде он так:</p>
<div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>(<span class="text-red">тип</span>) <span class="text-green">выражение</span></code></pre>
</div>
<p>Примеры:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>long <span class="text-green">a</span> = 1;
int <span class="text-green">b</span> = (<span class="text-red">int</span>) <span class="text-green">a</span>;
short <span class="text-green">c</span> = (<span class="text-red">short</span>) <span class="text-green">b</span>;
byte <span class="text-green">d</span> = (<span class="text-red">byte</span>)<span class="text-green"> c</span>;</code></pre>
        </td>
        <td style="vertical-align: middle;">Каждый раз нужно явно указывать оператор преобразования типа</td>
    </tr>
    </tbody>
</table>
<p>В данном случае <code><span class="text-green">a</span></code> равно <code>1</code>, и это кажется излишним. А что если бы <code><span class="text-green">a</span></code> было больше?</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>long <span class="text-green">a</span> = 1000000;
int <span class="text-green">b</span> = (<span class="text-red">int</span>) <span class="text-green">a</span>;
short <span class="text-green">c</span> = (<span class="text-red">short</span>) <span class="text-green">b</span>;
byte <span class="text-green">d</span> = (<span class="text-red">byte</span>) <span class="text-green">c</span>;</code></pre>
        </td>
        <td>
                <pre><code>a == 1000000
b == 1000000
c == 16960
d == 64</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Миллион отлично помещается и в тип <code>long</code>, и в тип <code>int</code>. А вот при присваивании миллиона переменной типа <code>short</code> два первых байта были отброшены, и остались только два последних байта. А при присваивании типу <code>byte</code> вообще остался один последний байт.</p>
<p>Устройство чисел в памяти:</p>
<table>
    <tbody>
    <tr>
        <th class="text-center">Тип</th>
        <th class="text-right">Двоичная запись</th>
        <th class="text-center">Десятичная запись</th>
    </tr>
    <tr>
        <td class="text-center"><code>int</code></td>
        <td style="text-align: right;">0b<span class="text-viola">00000000</span><span class="text-user">00001111</span><span class="text-orange">01000010</span><span class="text-green">01000000</span></td>
        <td class="text-center"><code>1,000,000</code></td>
    </tr>
    <tr>
        <td class="text-center"><code>short</code></td>
        <td style="text-align: right;">0b<span class="text-orange">01000010</span><span class="text-green">01000000</span></td>
        <td class="text-center"><code>16,960</code></td>
    </tr>
    <tr>
        <td class="text-center"><code>byte</code></td>
        <td style="text-align: right;">0b<span class="text-green">01000000</span></td>
        <td class="text-center"><code>64</code></td>
    </tr>
    </tbody>
</table>
<p><strong>Тип <code>char</code></strong></p>
<p>Тип <code>char</code>, как и тип <code>short</code>, занимает два байта, но для их преобразования в друг друга всегда нужно использовать оператор приведения типа. Все дело в том, что тип <code>short</code> знаковый, и может содержать значения от <code>-32,768</code> до <code>+32,767</code>, а тип <code>char</code> беззнаковый, и может содержать значения от <code>0</code> до <code>65,535</code>.</p>
<p>В <code>char</code> нельзя сохранить отрицательные числа, которые могут храниться в <code>short</code>. А в <code>short</code> нельзя сохранить числа больше <code>32,767</code>, которые могут храниться в <code>char</code>.</p>
<hr>
<h2>4. Тип выражения</h2>
<p>А что делать, если в одном выражении используются переменные разных типов? Логичный ответ &#8211; их сначала нужно преобразовать к общему типу. Но какому?</p>
<p><strong>Конечно же, к большему.</strong></p>
<p>В Java всегда происходит преобразование к типу большей размерности. Грубо говоря, сначала происходит расширение типа одного из участников операции, а уже затем операция со значениями одинаковых типов.</p>
<p>Если в выражении участвуют типы <code>int</code> и <code>long</code>, значение типа <code>int</code> будет преобразовано к типу <code>long</code> и только затем будет участвовать в операции:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>int <span class="text-red">a</span> = 1;
long <span class="text-green">b</span> = 2;
long <span class="text-viola">c</span> = <span class="text-red">a</span> + <span class="text-green">b</span>;</code></pre>
        </td>
        <td style="vertical-align: middle"><code><span class="text-red">a</span></code> будет расширена до типа <code>long</code> и только затем произойдет сложение.</td>
    </tr>
    </tbody>
</table>
<p><strong>Числа с плавающей точкой</strong></p>
<p>Если в выражении участвуют целое число и число с плавающей точкой (<code>float</code>/<code>double</code>), целое число будет преобразовано в число с плавающей точкой (<code>float</code>/<code>double</code>), и только потом будет выполнена операция над ними.</p>
<p>Если в операции участвуют <code>float</code> и <code>double</code>, то <code>float</code> будет преобразован к <code>double</code>. Что, собственно говоря, ожидаемо.</p>
<div class="lesson-note lesson-note--important">
    <div class="lesson-note__container">
        <div class="lesson-note__head">Сюрприз</div>
        <div class="lesson-note__content">
            <p>Типы <code>byte</code>, <code>short</code>, <code>char</code> всегда преобразовываются в тип <code>int</code> при взаимодействии между собой. Не&nbsp;зря же тип <code>int</code> считается стандартным целочисленным типом.</p>
        </div>
    </div>
</div>
<p>Если умножить <code>byte</code> на <code>short</code>, будет <code>int</code>. Если умножить <code>byte</code> на <code>byte</code>, будет <code>int</code>. Даже если сложить <code>byte</code> и <code>byte</code>, будет <code>int</code>.</p>
<p>Тому есть несколько причин. Примеры:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte <span class="text-red">a</span> = 110;
byte <span class="text-green">b</span> = 120;
byte <span class="text-viola">c</span> = <span class="text-red">a</span> * <span class="text-green">b</span>;   <span class="text-red">// ошибка</span></code></pre>
        </td>
        <td style="vertical-align: middle"><code>110 * 120</code> будет <code>13,200</code>, что несколько больше, чем максимальное значение типа <code>byte</code>: <code>127</code></td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte <span class="text-red">a</span> = 110;
byte <span class="text-green">b</span> = 120;
byte <span class="text-viola">c</span> = <span class="text-red">a</span> + <span class="text-green">b</span>;   <span class="text-red">// ошибка</span></code></pre>
        </td>
        <td style="vertical-align: middle"><code>110 + 120</code> будет <code>230</code>, что тоже несколько больше, чем максимальное значение типа <code>byte</code>: <code>127</code></td>
    </tr>
    </tbody>
</table>
<p>В общем случае при умножении числа длиной в 8 бит (1 байт) на число длиной в 8 бит (1 байт), мы получим число длиной 16&nbsp;бит (2 байта)</p>
<p>Поэтому все операции с целыми типами, меньшими чем <code>int</code>, всегда сразу преобразовываются в тип <code>int</code>. И поэтому если вы захотите сохранить результат вычисления в переменную типа, меньше чем <code>int</code>, вам всегда нужно будет явно указывать операцию приведения типа.</p>
<p>Примеры:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte <span class="text-red">a</span> = 110;
byte <span class="text-green">b</span> = 120;
byte <span class="text-viola">c</span> = (<span class="text-orange">byte</span>) (<span class="text-red">a</span> * <span class="text-green">b</span>);</code></pre>
        </td>
        <td style="vertical-align: middle">выражение <code>byte * byte</code> будет иметь тип <code>int</code></td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte <span class="text-red">a</span> = 110;
byte <span class="text-green">b</span> = 120;
byte <span class="text-viola">c</span> = (<span class="text-orange">byte</span>) (<span class="text-red">a</span> + <span class="text-green">b</span>);</code></pre>
        </td>
        <td style="vertical-align: middle">выражение <code>byte + byte</code> будет иметь тип <code>int</code></td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte <span class="text-red">a</span> = 1;
byte <span class="text-green">b</span> = (<span class="text-orange">byte</span>) (<span class="text-red">a</span> + 1);</code></pre>
        </td>
        <td style="vertical-align: middle">выражение <code>byte + int</code> будет иметь тип <code>int</code><br>
            единица – это литерал типа <code>int</code>.
        </td>
    </tr>
    </tbody>
</table>
<hr>
<h2>5. Важный нюанс</h2>
<p><span class="text-orange">Операция приведения типа имеет довольно высокий приоритет.</span></p>
<p>Поэтому если в выражении есть, допустим, сложение и операция приведения типа, она будет выполнена до сложения.</p>
<p>Пример:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte a = 1;
byte b = 2;
byte c = <span class="text-red">(byte) a</span> * b;</code></pre>
        </td>
        <td style="vertical-align: middle">Оператор приведения типа будет применен только к переменной <code><span class="text-red">a</span></code>, которая и так имеет тип <code>byte</code>. Код не скомпилируется.</td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>byte a = 1;
byte b = 2;
byte c = <span class="text-orange">(byte) (a * b)</span>;</code></pre>
        </td>
        <td style="vertical-align: middle">Вот так правильно.</td>
    </tr>
    </tbody>
</table>
<p>Если вы хотите преобразовать к определенному типу все выражение, а не только один его элемент, то <span class="text-green">оборачивайте все выражение в круглые скобки и перед ними ставьте оператор приведения типа.</span></p>
<hr>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task07.task0708"></div>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task07.task0709"></div>
Работа с файлами в Java
<p>----------------------------------------</p>
Класс Files  Для того, чтобы работать с файлами есть шикарный утилитный класс – java.nio.file.Files. У него есть методы просто на все случаи жизни. Все методы этого класса статические и работают с объектами типа Path. Методов очень много, поэтому мы рассмотрим только основные:    Метод Описание 
<p>----------------------------------------</p>
<h2>1. Класс <code>Files</code></h2>
<p><img data-id="a86a798d-c988-4532-95a6-864dab6dfa51" src="https://cdn.javarush.com/images/article/a86a798d-c988-4532-95a6-864dab6dfa51/original.png" alt="Класс Files"></p>
<p>Чтобы работать с файлами, есть шикарный утилитный класс — <code><span class="text-red">java.nio.file.Files</span></code>. У него есть методы просто на все случаи жизни. Все методы этого класса статические и работают с объектами типа Path. Методов очень много, поэтому мы рассмотрим только основные:</p>
<table>
    <tbody>
    <tr>
        <th width="55%">Метод</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">createFile</span>(Path path)</code></pre>
        </td>
        <td>Создает новый файл с путем <code>path</code></td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">createDirectory</span>(Path path)</code></pre>
        </td>
        <td>Создает новую директорию</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">createDirectories</span>(Path path)</code></pre>
        </td>
        <td>Создает несколько директорий</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">createTempFile</span>(prefix, suffix)</code></pre>
        </td>
        <td>Создает временный файл</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">createTempDirectory</span>(prefix)</code></pre>
        </td>
        <td>Создает временную директорию</td>
    </tr>
    <tr>
        <td>
            <pre><code>void <span class="text-red">delete</span>(Path path)</code></pre>
        </td>
        <td>Удаляет файл или директорию, если она пуста</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">copy</span>(Path src, Path dest)</code></pre>
        </td>
        <td>Копирует файл</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">move</span>(Path src, Path dest)</code></pre>
        </td>
        <td>Перемещает файл</td>
    </tr>
    <tr>
        <td>
            <pre><code>boolean <span class="text-red">isDirectory</span>(Path path)</code></pre>
        </td>
        <td>Проверяет, что путь — это директория, а не файл</td>
    </tr>
    <tr>
        <td>
            <pre><code>boolean <span class="text-red">isRegularFile</span>(Path path)</code></pre>
        </td>
        <td>Проверяет, что путь — это файл, а не директория</td>
    </tr>
    <tr>
        <td>
            <pre><code>boolean <span class="text-red">exists</span>(Path path)</code></pre>
        </td>
        <td>Проверяет, что объект по заданному пути существует</td>
    </tr>
    <tr>
        <td>
            <pre><code>long <span class="text-red">size</span>(Path path)</code></pre>
        </td>
        <td>Возвращает размер файла</td>
    </tr>
    <tr>
        <td>
            <pre><code>byte[] <span class="text-red">readAllBytes</span>(Path path)</code></pre>
        </td>
        <td>Возвращает все содержимое файла в виде массива байт</td>
    </tr>
    <tr>
        <td>
            <pre><code>String <span class="text-red">readString</span>(Path path)</code></pre>
        </td>
        <td>Возвращает все содержимое файла в виде строки</td>
    </tr>
    <tr>
        <td>
            <pre><code>List&lt;String&gt; <span class="text-red">readAllLines</span>(Path path)</code></pre>
        </td>
        <td>Возвращает все содержимое файла в виде списка строк</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">write</span>(Path path, byte[])</code></pre>
        </td>
        <td>Записывает в файл массив байт</td>
    </tr>
    <tr>
        <td>
            <pre><code>Path <span class="text-red">writeString</span>(Path path, String str)</code></pre>
        </td>
        <td>Записывает в файл строку</td>
    </tr>
    <tr>
        <td>
            <pre><code>DirectoryStream&lt;Path&gt; <span class="text-red">newDirectoryStream</span>(Path dir)</code></pre>
        </td>
        <td>Возвращает коллекцию файлов (и поддиректорий) из заданной директории</td>
    </tr>
    </tbody>
</table>
<hr>
<h2>2. Создание файлов и директорий</h2>
<p>Файлы и директории создавать очень просто. Убедимся на примерах:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Примечание</th>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>Files.<span class="text-red">createFile</span>(Path.of(<span class="text-green">"c:\\readme.txt"</span>));</code></pre>
        </td>
        <td>Создает файл</td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>Files.<span class="text-red">createDirectory</span>(Path.of(<span class="text-green">"c:\\test"</span>));</code></pre>
        </td>
        <td>Создает директорию</td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>Files.<span class="text-red">createDirectories</span>(Path.of(<span class="text-green">"c:\\test\\1\\2\\3"</span>));</code></pre>
        </td>
        <td>Создает директорию и все нужные поддиректории, если их не существует.</td>
    </tr>
    </tbody>
</table>
<hr>
<h2>3. Копирование, перемещение и удаление</h2>
<p>Копировать, перемещать и удалять файлы так же легко. На директории это тоже распространяется, но они должны быть пустые.</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Примечание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>Path path1 = Path.of(<span class="text-green">"c:\\readme.txt"</span>);
Path path2 = Path.of(<span class="text-green">"c:\\readme-copy.txt"</span>);
Files.<span class="text-red">copy</span>(path1, path2);</code></pre>
        </td>
        <td>Копирует файл</td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>Path path1 = Path.of(<span class="text-green">"c:\\readme.txt"</span>);
Path path2 = Path.of(<span class="text-green">"d:\\readme-new.txt")</span>;
Files.<span class="text-red">move</span>(path1, path2);</code></pre>
        </td>
        <td>Перемещает и переименовывает файл</td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>Path path = Path.of(<span class="text-green">"d:\\readme-new.txt"</span>);
Files.<span class="text-red">delete</span>(path);</code></pre>
        </td>
        <td>Удаляет файл</td>
    </tr>
    </tbody>
</table>
<hr>
<h2>4. Проверка типа файла и факта существования</h2>
<p>Когда у вас есть какой-то путь, полученный извне, вы бы хотели знать, это файл или директория. Ну и вообще: существует такой файл/директория или нет?</p>
<p>Для этого тоже есть специальные методы. Так же можно легко узнать длину файла:</p>
<table>
    <tbody>
    <tr>
        <th width="65%">Код</th>
        <th>Примечание</th>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>Files.<span class="text-red">isRegularFile</span>(<span class="code">Path.of(<span class="text-green">"c:\\readme.txt"</span>)</span>);</code></pre>
        </td>
        <td>
            <pre><code>true</code></pre>
        </td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>Files.<span class="text-red">isDirectory</span>(<span class="code">Path.of(<span class="text-green">"c:\\test"</span>)</span>);</code></pre>
        </td>
        <td>
            <pre><code>true</code></pre>
        </td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code> Files.<span class="text-red">exists</span>(<span class="code">Path.of(<span class="text-green">"c:\\test\\1\\2\\3"</span>)</span>);</code></pre>
        </td>
        <td>
            <pre><code>false</code></pre>
        </td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>Files.<span class="text-red">size</span>(<span class="code">Path.of(<span class="text-green">"c:\\readme.txt"</span>)</span>);</code></pre>
        </td>
        <td>
            <pre><code>10112</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<hr>
<h2>5. Работа с содержимым файла</h2>
<p>И наконец, есть целая серия методов, которые позволяют легко прочитать или записать содержимое файла. Пример:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>Path <span class="code text-green">path</span> = Path.of(<span class="text-green">"c:\\readme.txt"</span>);
List&lt;String&gt; <span class="code text-user">list</span> = Files.<span class="text-red">readAllLines</span>(<span class="code text-green">path</span>);

for (String <span class="code text-orange">str</span> : <span class="code text-user">list</span>)
   System.out.println(<span class="code text-orange">str</span>);</code></pre>
        </td>
        <td><br>Читаем содержимое файла в виде списка строк.<br><br>
            Выводим строки на экран
        </td>
    </tr>
    </tbody>
</table>
<hr>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task15.task1516"></div>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task15.task1517"></div>
<hr>
<h2>6. Получение содержимого директории</h2>
<p>Остался еще самый интересный метод — получение файлов и поддиректорий в заданной директории.</p>
<p>Для этого есть специальный метод — <code>newDirectoryStream()</code>, который возвращает специальный объект типа <code>DirectoryStream&lt;Path&gt;</code>. У него есть итератор(!), и с помощью этого итератора можно получить все файлы и поддиректории заданной директории.</p>
<p>Выглядит проще, чем кажется:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>Path <span class="code text-green">path</span> = Path.of(<span class="text-green">"c:\\windows"</span>);

try (<span class="text-neon">DirectoryStream</span>&lt;<span class="text-viola">Path</span>&gt; <span class="code text-user">files</span> = <span class="text-neon">Files</span>.newDirectoryStream(<span class="code text-green">path</span>)) {
   for (<span class="text-viola">Path</span> <span class="code text-orange">path</span> : <span class="code text-user">files</span>)
      System.out.println(<span class="code text-orange">path</span>);
}</code></pre>
        </td>
        <td><br><br>Получаем объект со списком файлов<br>
            <span>Цикл по списку файлов</span></td>
    </tr>
    </tbody>
</table>
<p>Объект <code>DirectoryStream&lt;Path&gt;</code> обладает двумя свойствами. Во-первых, у него есть итератор, который возвращает пути к файлам, и мы можем этот объект использовать внутри цикла <code>for-each</code>.</p>
<p><span class="text-orange">А во-вторых, этот объект является потоком данных, и его нужно закрывать с помощью метода <code><span class="text-orange">close()</span></code>, ну или использовать внутри <code>try</code>-with-resources.</span></p>
<hr>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task15.task1518"></div>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task15.task1519"></div>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task15.task1520"></div>
<hr>
<h2>7. Метод <code>Files.newInputStream</code></h2>
<p>Начиная с Java 5 классы <code>FileInputStream</code> и <code>FileOutputStream</code> стали считаться устаревшими. Одним из их минусов было то, что при создании объекта этих классов сразу происходит создание файлов на диске. И потенциально выбрасываются все ошибки, связанные с созданием файлов.</p>
<p>Впоследствии это было признано не самым хорошим решением. Поэтому для создания объектов-файлов рекомендуется использовать методы утилитного класса – <code>java.nio.Files</code>.</p>
<p>Вот сравнение старого подхода к созданию файлов и нового:</p>
<table>
    <tr>
        <th>Было</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>String <span class="code text-green">src</span> = "c:\\projects\\log.txt";
InputStream <span class="code text-user">input</span> = new FileInputStream( <span class="code text-green">src</span> );</code></pre>
        </td>
    </tr>
    <tr>
        <th>Стало</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>String <span class="code text-green">src</span> = "c:\\projects\\log.txt";
InputStream <span class="code text-user">input</span> = Files.newInputStream( Path.of( <span class="code text-green">src</span> ) );</code></pre>
        </td>
    </tr>
</table>
<p>Аналогично замена и для <code>FileOutputStream</code>:</p>
<table>
    <tr>
        <th>Было</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>String <span class="code text-green">src</span> = "c:\\projects\\log.txt";
OutputStream  <span class="code text-user">output</span> = new FileOutputStream( <span class="code text-green">src</span> );</code></pre>
        </td>
    </tr>
    <tr>
        <th>Стало</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>String <span class="code text-green">src</span> = "c:\\projects\\log.txt";
OutputStream  <span class="code text-user">output</span> = Files.newOutputStream( Path.of( <span class="code text-green">src</span> ) );</code></pre>
        </td>
    </tr>
</table>
<hr>
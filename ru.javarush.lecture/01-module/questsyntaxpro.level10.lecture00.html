Устройство Java-программы
<p>----------------------------------------</p>
Объекты и классы Сегодня вы узнаете немного о том, как устроена типичная программа на Java. И главная новость:&nbsp;каждая программа на Java состоит из классов и объектов. Что такое классы вы уже знаете, а что такое объекты? Начну с аналогии. Представьте, что вы хотите сделать небольшой корабль.
<p>----------------------------------------</p>
<div class="lesson-carousel lesson-carousel--comics lesson-carousel--desktop">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="5b789bb5-f387-4967-b6f8-ed4234c0b807" src="https://cdn.javarush.com/images/article/5b789bb5-f387-4967-b6f8-ed4234c0b807/original.png" alt="">
        </div>
    </div>
</div>
<div class="lesson-carousel lesson-carousel--comics lesson-carousel--mobile">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="b820607b-3df5-4ea5-a4b7-f222701e1e19" src="https://cdn.javarush.com/images/article/b820607b-3df5-4ea5-a4b7-f222701e1e19/original.png" alt="">
        </div>
        <div class="lesson-carousel__item">
            <img data-id="caa90881-9fea-44ff-aaf1-22778c86831d" src="https://cdn.javarush.com/images/article/caa90881-9fea-44ff-aaf1-22778c86831d/original.png" alt="">
        </div>
    </div>
</div>
<hr>
<h2>1. Объекты и классы</h2>
<p>Сегодня вы узнаете немного о том, как устроена типичная программа на Java. И главная новость: каждая программа на Java состоит из классов и объектов.</p>
<p>Что такое классы, вы уже знаете, а что такое объекты?</p>
<p>Начну с аналогии. Представьте, что вы хотите сделать небольшой корабль. Сначала нужно сделать чертёж, затем отдать его на завод, где по этому чертежу соберут корабль. Или десяток. Да вообще, сколько угодно кораблей. По одному чертежу строятся десятки идентичных кораблей, вот что важно.</p>
<p>В программировании на Java все точно так же.</p>
<p><strong>Чертежи</strong></p>
<p>Программист — он как проектировщик. Только проектировщик рисует чертежи, а Java-программист пишет классы. Затем на основе чертежей создаются детали, а на основе классов — объекты.</p>
<p>Сначала мы пишем классы (делаем чертежи), а потом, во время исполнения программы, на основе этих классов Java-машина создает объекты. Точно так же, как корабли создаются на основе чертежей.</p>
<p>Чертёж один, но кораблей может быть много. Корабли разные, у них разные имена, они возят разные грузы. Но они очень похожие: они все — корабли с идентичной конструкцией, и могут выполнять аналогичные задачи.</p>
<p>Или вот еще аналогия...</p>
<p><strong>Муравейник</strong></p>
<p>Муравейник — это хороший пример взаимодействия объектов. В простейшем муравейнике есть три класса муравьёв: королева, воины и рабочие муравьи.</p>
<p>Количество муравьёв каждого класса — разное. Королева — одна на весь муравейник, воинов — десятки, а рабочих муравьёв — сотни. Три класса и сотни объектов. Муравьи взаимодействуют друг с другом, с такими же муравьями и муравьями других классов по жёстко заданным правилам.</p>
<p>Это просто идеальный пример. В типичной программе все точно так же. Есть главный объект, который создаёт объекты всех остальных классов. Объекты начинают взаимодействовать друг с другом и «внешним миром» программы. Внутри этих объектов жёстко запрограммировано их поведение.</p>
<p>Два этих пояснения — это две стороны одной медали. Истина посередине. Первый пример (про чертеж и корабли) показывает связь между классом и объектами этого класса. Аналогия очень сильная. Второй пример (про муравейник) показывает связь между объектами, которые существуют во время работы программы, и написанными классами.</p>
<p>Сначала вы должны написать классы для всех существующих в программе объектов, а потом ещё и описать их взаимодействие. Да, это так, но это легче, чем кажется.</p>
<p>В Java все сущности во время работы программы являются объектами, а написание программы сводится к описанию различных способов взаимодействия объектов. Объекты просто вызывают методы друг друга и передают в них нужные данные.</p>
<p><strong>Документация</strong></p>
<p>А как узнать, какие данные передавать в методы? Тут все уже придумано до вас.</p>
<p>Обычно у каждого класса есть описание, в котором говорится, для чего он создан. Также обычно и у каждого публичного метода есть описание: что он делает, и какие данные нужно в него передавать.</p>
<p>Чтобы использовать класс, нужно в общих чертах знать, что он делает. А также нужно точно знать, что делает каждый его метод. И совсем не обязательно знать, как он это делает. Такая себе волшебная палочка.</p>
<p>Давайте посмотрим на код — копирование файла:</p>
<table>
    <tbody>
    <tr>
        <th>Копирование файла c:\data.txt в файл c:\result.txt</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>package com.javarush.lesson2;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class FileCopy
{
   public static void main(String[] args) throws IOException
   {
      FileInputStream fileInputStream = new FileInputStream("c:\\data.txt");
      FileOutputStream fileOutputStream = new FileOutputStream("c:\\result.txt");

      while (fileInputStream.available() &gt; 0)
      {
         int data = fileInputStream.read();
         fileOutputStream.write(data);
      }

      fileInputStream.close();
      fileOutputStream.close();
   }
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Если прочитать это код построчно, можно догадаться, что он делает в общих чертах. Хотя тут нужен опыт и практика. Так что спустя некоторое время этот код вам покажется знакомым и понятным.</p>
<hr>
<h2>2. Проектирование программы</h2>
<p>Проектирование программы — это целое искусство. Это и просто, и сложно одновременно. Просто, потому что никаких жестких законов нет: все, что не запрещено — разрешено. Ну а сложно тоже по этой причине: очень много способов что-то сделать и непросто найти самый лучший.</p>
<p>Проектировать программу — это как писать книгу. С одной стороны, вы просто пишете буквы, слова, предложения. А с другой &#8211; важен сюжет, характеры героев, внутренние противоречия, конфликты, стиль повествования, интрига и т.п.</p>
<p>Главное — понимать, для кого вы пишете код. А код вы пишете <strong>для других программистов.</strong></p>
<p>Разработка любого продукта — это внесение изменений: добавили здесь, удалили там, переделали тут. И так маленькими итерациями рождаются большие, огромные и гигантские проекты.</p>
<p>Главное требование к коду — <strong>он должен быть понятен другим программистам.</strong> <span class="text-green">Неправильный, но понятный код можно исправить. <span class="text-orange">Правильный и непонятный код улучшать не получится.</span></span> Его останется только выбросить.</p>
<p>Так как же писать хороший и понятный код?</p>
<p>Для этого нужно делать три вещи:</p>
<ul>
    <li>Писать хороший и понятный код внутри методов — самое простое.</li>
    <li>Решить, какие сущности должны быть в программе</li>
    <li>Правильно разбивать программу на логические части</li>
</ul>
<p>Что же стоит за этими понятиями?</p>
<p><strong>Писать хороший код внутри методов</strong></p>
<p>Если у вас хотя бы начальный уровень английского, возможно, вы обратили внимание, как легко иногда читается код: как предложения на английском языке:</p>
<ul>
    <li><code>class Cat extends Pet</code> &#8211;  класс Кот расширяет класс ДомашнееЖивотное</li>
    <li><code>while(stream.ready())</code> – пока поток готов ...</li>
    <li><code>if (a&lt;b) return a; else return b</code> – если <code>а</code> меньше <code>b</code>, вернуть <code>а</code>, иначе вернуть <code>b</code>.</li>
</ul>
<p>Так сделано специально. Java — один из нескольких языков, в которых легко писать самодокументированный код: код, который понятен без комментариев. В хорошем коде в Java многие методы читаются просто как предложения на английском языке.</p>
<p>Ваша задача при написании кода — тоже делать его максимально простым и лаконичным. Просто думайте, а насколько ваш код будет легко читать, и вы начнете двигаться в правильном направлении.</p>
<p>В Java принято писать легко читаемый код. Желательно, чтобы каждый метод целиком помещался на экран (длина метода — 20-30 строк). Это норма для всего Java-комьюнити. <strong>Если код можно улучшить, его нужно улучшить.</strong></p>
<p>Лучший способ научиться писать хороший код — постоянная практика. Пишите много кода, изучайте чужой код, просите более опытных коллег сделать ревью вашего кода.</p>
<p>И помните, что в тот момент, когда вы себе скажете «и так сойдет», ваше развитие остановится.</p>
<p><strong>Решать, какие сущности должны быть в программе</strong></p>
<p>Вам нужно писать код, понятный для других программистов. Если 9 из 10 программистов при проектировании программы сделают в ней классы A, B и С, то и вам тоже нужно сделать в вашей программе классы A, B, и C. Вы должны писать код, понятный для других.</p>
<p>Отличный, работающий, быстрый, нестандартный код — это плохой код.</p>
<p>Вам нужно изучать чужие проекты: это самый лучший, самый быстрый и самый легкий способ перенять всю мудрость, которая десятилетиями копилась в ИТ-индустрии.</p>
<p>И, кстати, у вас уже есть под рукой отличный, популярный, хорошо документированный проект — <strong>Java SDK</strong>. Начните с него.</p>
<p>Разбирайте классы и структуры классов. Думайте, почему одни методы сделаны статическими, а другие — нет. Почему у методов именно такие параметры, а не другие. Почему именно такие методы, почему классы называются именно так и находятся именно в таких пакетах.</p>
<p>Когда вы начнете понимать ответы на все эти вопросы, вы сможете писать код, понятный другим.</p>
<p>Однако хочу предостеречь вас от разбора <strong>кода в методах</strong> Java SDK. Код многих методов был переписан с целью максимизации скорости работы — его читабельность под большим вопросом.</p>
<p><strong>Правильно разбивать программу на логические части</strong></p>
<p>Любую программу обычно разбивают на части или модули. Каждая часть отвечает за свой аспект программы.</p>
<p>Вот у компьютера есть системный блок, монитор, клавиатуры, и это все отдельные, малозависимые части. Более того, их взаимодействие стандартизировано: USB, HDMI и т.п. Зато если вы прольете кофе на клавиатуру, вы можете просто помыть ее под краном, просушить и пользоваться дальше.</p>
<p>А вот ноутбук — это пример монолитной архитектуры: логические части вроде и есть, но интегрированы гораздо сильнее. У MacBookPro, чтобы почистить клавиатуру, нужно разобрать половину ноутбука. А пролитый на ноутбук кофе — повод заказать новый. Только не кофе.</p>
<hr>
<h2>3. Создание своих классов</h2>
<p>Но т.к. вы только учитесь программировать, вам нужно начинать с малого — учиться создавать собственные классы.</p>
<p>Вы их, конечно же, уже создавали, но вам нужно учиться понимать, какие классы должны быть в программе, как они должны называться, какие у них должны быть методы. И как они должны друг с другом взаимодействовать.</p>
<p><strong>Список сущностей</strong></p>
<p>Если вы не знаете, с чего начать, начните с начала.</p>
<p>В самом начале проектирования программы вы можете просто выписать на листик список сущностей (объектов), которые должны быть в программе. А потом запрограммировать их по такому принципу: каждая сущность — отдельный класс.</p>
<p><strong>Пример</strong></p>
<p>Допустим, вы хотите написать игру в шахматы. Вам понадобятся такие сущности: шахматная доска и 6 типов фигур. Фигуры ходят по-разному, имеют разную ценность — логично, что это отдельные классы. И вообще, в самом начале, чем больше классов — тем лучше.</p>
<p>Встретить программиста-новичка, который вместо двух классов написал бы десять — большая редкость. Вот вместо десяти написать два, а то и один — это новички любят. Так что больше классов, господа программисты. И ваш код станет понятнее всем, кроме, возможно вас 😛</p>
<p><strong>Шахматы</strong></p>
<p>Допустим, мы решили писать классы для шахмат: как бы эти классы выглядели?</p>
<p>Шахматная доска — это просто массив 8 на 8? Лучше сделайте для нее отдельный класс, который внутри хранит ссылку на массив. Тогда в класс «шахматная доска» вы сможете добавить много полезных методов, которые, например, проверяют, что клетка пустая или занята</p>
<p>В общем, в начале всегда можно руководствоваться принципом: Программа имеет разные Сущности, а у Сущности есть тип. Вот этот тип — это и есть класс.</p>
<hr>
<h2>4. Статические переменные и методы</h2>
<p>Также не забывайте пользоваться статическими переменными и методами. Если у вас одна шахматная фигура взаимодействует с другой на шахматной доске, значит, в коде у вас должен быть метод, в который передаются ссылки на первую фигуру, на вторую и на шахматную доску.</p>
<p>Чтобы постоянно не передавать ссылки на объекты, которые «существуют всегда», их обычно делают статическими переменными, и к ним можно обратиться из любого места программы.</p>
<p>Например, так:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Примечание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>public class <span class="text-neon">ChessBoard</span>
{
   public static <span class="text-neon">ChessBoard</span> <span class="text-red">board</span> = new <span class="text-neon">ChessBoard</span>();
   public <span class="text-viola">ChessItem</span>[][] <span class="text-user">cells</span> = new <span class="text-viola">ChessItem</span>[8][8];
   ...
}

public class Game
{
   public static void main(String[] args)
   {
      var <span class="text-green">board</span> = <span class="text-neon">ChessBoard</span>.<span class="text-red">board</span>;
      <span class="text-green">board</span>.<span class="text-user">cells</span>[<span class="text-user">0</span>][<span class="text-user">3</span>] = new <span class="text-viola">King</span>(Color.WHITE);
      <span class="text-green">board</span>.<span class="text-user">cells</span>[<span class="text-user">0</span>][<span class="text-user">4</span>] = new <span class="text-viola">Queen</span>(Color.WHITE);
      ...
   }
}</code></pre>
        </td>
        <td><br><br>Ссылка на единственный объект типа <code>ChessBoard</code>.<br>
            Двумерный массив 8&#215;8, не статическая переменная.<br><br><br><br><br><br><br><br><br>
            Добавляем фигуры на доску.
        </td>
    </tr>
    </tbody>
</table>
<p>Ну или вместо статической переменной можно сделать метод, который возвращает единственный объект. Например, так:</p>
<pre class="language-java"><code>public class <span class="text-neon">ChessBoard</span>
{
   private static <span class="text-neon">ChessBoard</span> <span class="text-red">board</span> = new <span class="text-viola">ChessBoard</span>();
   public static <span class="text-neon">ChessBoard</span> getBoard()
   {
      return <span class="text-red">board</span>;
   }

   public <span class="text-viola">ChessItem</span>[][] <span class="text-user">cells</span> = new <span class="text-viola">ChessItem</span>[8][8];
   ...
}

public class <span class="text-viola">Game</span>
{
   public static void main(String[] args)
   {
      var <span class="text-green">board</span> = <span class="text-neon">ChessBoard</span>.<span class="text-red">getBoard</span>();
      <span class="text-green">board</span>.<span class="text-user">cells</span>[<span class="text-user">0</span>][<span class="text-user">3</span>] = new <span class="text-viola">King</span>(Color.WHITE);
      <span class="text-green">board</span>.<span class="text-user">cells</span>[<span class="text-user">0</span>][<span class="text-user">4</span>] = new <span class="text-viola">Queen</span>(Color.WHITE);
      ...
   }
}</code></pre>
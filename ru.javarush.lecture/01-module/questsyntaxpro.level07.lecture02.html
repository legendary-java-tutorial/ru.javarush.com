Переменные-ссылки в Java
<p>----------------------------------------</p>
Переменные-ссылки В языке Java переменные могут быть двух видов: переменные примитивного типа и все остальные. Вот про «все остальные» мы сейчас и поговорим. На самом деле более правильно будет сказать, что есть переменные примитивного типа (primitive typevariables) и ссылочные переменные (refer
<p>----------------------------------------</p>
<div class="lesson-carousel lesson-carousel--comics lesson-carousel--desktop">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="35297677-17a3-42ad-963e-88407198b228" src="https://cdn.javarush.com/images/article/35297677-17a3-42ad-963e-88407198b228/original.png" alt="">
        </div>
    </div>
</div>
<div class="lesson-carousel lesson-carousel--comics lesson-carousel--mobile">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="61a85e83-2c2d-4070-a470-a38af5cff744" src="https://cdn.javarush.com/images/article/61a85e83-2c2d-4070-a470-a38af5cff744/original.png" alt="">
        </div>
        <div class="lesson-carousel__item">
            <img data-id="24a222a7-a402-49ef-b29f-db4892691416" src="https://cdn.javarush.com/images/article/24a222a7-a402-49ef-b29f-db4892691416/original.png" alt="">
        </div>
    </div>
</div>
<hr>
<h2>1. Переменные-ссылки</h2>
<p>В языке Java переменные могут быть двух видов: переменные примитивного типа и все остальные. Вот про «все остальные» мы сейчас и поговорим.</p>
<p>На самом деле правильнее будет сказать, что есть переменные примитивного типа (<strong>primitive type variables</strong>) и ссылочные переменные (<strong>reference variables</strong>). Так что же это такое, эти ссылочные переменные?</p>
<p>В отличие от примитивных типов, которые позволяют хранить значения прямо внутри переменных, переменные ссылочных типов хранят <strong>ссылки на объекты.</strong> Т.е. где-то в памяти существует некий объект, а в переменной-ссылке просто хранится адрес этого объекта в памяти (ссылка).</p>
<p>Значения прямо внутри переменных хранят <span class="text-green">только примитивные типы</span>, <strong>все</strong> остальные типы хранят только <span class="text-user">ссылку на объект</span>. Ранее вы уже, кстати, сталкивались с двумя такими типами переменных — это переменные типа <code>String</code> и переменные типа <span class="term">массив</span>.</p>
<p>И массив, и строка являются объектами, которые хранятся где-то в памяти. Переменные типа <code>String</code> и переменные типа массив хранят только ссылки на объекты.</p>
<p><img data-max-width="1024" data-id="542138f4-da3f-48de-8c8e-d2a46c9c4a9b" src="https://cdn.javarush.com/images/article/542138f4-da3f-48de-8c8e-d2a46c9c4a9b/1024.jpeg" alt=""></p>
<p>Переменные <code>int a, int b и double d</code> — примитивные и хранят значение внутри себя.</p>
<p>Переменная <code>String str</code> — ссылочная и хранит адрес (ссылку) объекта типа <code>String</code> в памяти.</p>
<p>При присваивании примитивного значения переменной примитивного типа, его значение копируется (дублируется). При присваивании же ссылочной переменной <span class="text-green">копируется только адрес объекта</span>, <span class="text-orange">сам же объект при этом</span> <span class="text-red">не копируется</span>.</p>
<hr>
<h2>2. Суть ссылок</h2>
<p>В чем принципиальное отличие переменных-ссылок от примитивных переменных?</p>
<p>Примитивная переменная — как коробка: в ней можно хранить какое-нибудь значение. Переменная-ссылка больше похожа на листок бумаги с телефонным номером на нем.</p>
<p><strong>Машина vs ключи от машины</strong></p>
<p>Представьте, что вы решили подарить другу на день рождения машину. Вы же не будете заворачивать ее в коробку и нести с собой: машина для этого слишком большая.</p>
<p>Гораздо удобнее взять с собой только ключи от машины и коробку, достаточно вместительную для них. А ваш друг и так все поймет, когда достанет из коробки ключи. Нет нужды нести с собой всю машину, когда можно просто передать ключи.</p>
<p><strong>Человек vs его телефонный номер</strong></p>
<p>Или еще один вариант: человек и его телефонный номер. Телефонный номер — не сам человек, но номер телефона можно использовать, чтобы звонить ему, спрашивать у него какую-то информацию, давать команды.</p>
<p>Ссылка тоже используется для взаимодействия с объектом. Все объекты взаимодействуют друг с другом при помощи ссылок. Вместо того, чтобы «обмениваться людьми», достаточно обменяться телефонными номерами.</p>
<p>При присваивании значения в примитивную переменную, его значение копируется (дублируется). При присваивании же значения ссылочной переменной копируется только адрес объекта («телефонный номер»), сам же объект при этом не копируется.</p>
<p>Ссылка даёт ещё одно преимущество: можно передать ссылку на объект в какой-нибудь метод, и этот метод будет в состоянии модифицировать (изменять) наш объект, используя ссылку на него, вызывая его методы и обращаясь к данным внутри объекта.</p>
<hr>
<h2>3. Присваивание ссылок</h2>
<p>При присваивании ссылочных переменных происходит просто присваивание адреса объекта в памяти. Сами объекты при этом не появляются и не исчезают.</p>
<p>Такой подход позволяет избежать копирования больших объемов памяти. Если куда-то нужно передать очень большой объект, мы просто передадим в этот метод ссылку на объект и все. Ссылка занимает гораздо меньше места.</p>
<p><img data-id="f38ef34f-4d61-4c33-bf70-a3029c2095ba" src="https://cdn.javarush.com/images/article/f38ef34f-4d61-4c33-bf70-a3029c2095ba/original.png" alt="Присваивание ссылок"></p>
<p>Размер всех переменных-ссылок (независимо от типа) одинаков и составляет 4 байта (как тип int). Но! Если ваше приложение запущено на 64-х разрядной Java-машине, размер всех ссылок будет 8 байт (64 бита).</p>
<p>Ссылки при этом можно только присваивать друг другу. Вы не можете менять ссылки или присваивать им произвольные значения:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>String <span class="text-user">hello</span> = "Привет";
String <span class="text-viola">s</span> = <span class="text-user">hello</span>;</code></pre>
        </td>
        <td>Так <span class="text-green">можно</span></td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>String <span class="text-red">hello</span> = "Привет";
<span class="text-red">hello</span>++;</code></pre>
        </td>
        <td>А так — <span class="text-red">нельзя</span></td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>String <span class="text-red">hello = 0x1234</span>;</code></pre>
        </td>
        <td>И так — <span class="text-red">нельзя</span></td>
    </tr>
    </tbody>
</table>
<hr>
<h2>4. Пустая ссылка — <code>null</code></h2>
<p>А что хранит переменная-ссылка, если ей еще ничего не присвоили?</p>
<p>А хранит она пустую ссылку — <span class="text-red">null</span>. <code>null</code> — это специальное ключевое слово в Java, обозначающее отсутствие ссылки (пустую ссылку). Значение <code>null</code> можно присвоить любой ссылочной переменной.</p>
<p>Все переменные-ссылки, если им не присвоена какая-нибудь ссылка, имеют значение <code>null</code>.</p>
<p>Примеры:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>class Person
{
   public static <span class="text-red">String name</span>;
   public static int age;
}</code></pre>
        </td>
        <td><br><br>Переменная <code><span class="text-red">String name</span></code> имеет значение по умолчанию: <code>null</code>.<br>
            Переменная <code>int age</code> имеет значение по умолчанию: <code>0</code>.
        </td>
    </tr>
    </tbody>
</table>
<p>Локальные переменные без значения считаются неинициализированными как для примитивных типов, так и для типов-ссылок.</p>
<p>Если переменная хранит ссылку на какой-то объект, а вы хотите стереть значение переменной, просто присвойте ей ссылку null.</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>String <span class="text-red">s</span> = null;
<span class="text-red">s</span> = "Привет";
<span class="text-red">s</span> = null;</code></pre>
        </td>
        <td><code><span class="text-red">s</span></code> хранит ссылку <code>null</code>.<br>
            <code><span class="text-red">s</span></code> хранит ссылку на объект-строку<br>
            <code><span class="text-red">s</span></code> хранит ссылку <code>null</code></td>
    </tr>
    </tbody>
</table>
<hr>
<h2>5. Передача ссылок в методы</h2>
<p>Если у какого-нибудь метода есть параметры <span class="term">ссылочные переменные</span>, передача значений в них происходит точно так же, как и при работе с обычными переменными. Переменной-параметру просто присваивается значение другой переменной.</p>
<p>Пример:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Описание</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>class Solution
{
   public static void <span class="text-red">fill</span>(String[] <span class="text-orange">array</span>, String <span class="text-green">value</span>)
   {
      for (int i = 0; i &lt; <span class="text-orange">array</span>.length; i++)
        <span class="text-orange">array</span>[i] = <span class="text-green">value</span>;
   }

   public static void main(String[] args)
   {
     String[] <span class="text-user">data</span> = new String[<span class="text-user">10</span>];
     <span class="text-red">fill</span>(<span class="text-user">data</span>, <span class="text-green">"Hello"</span>);
   }
}</code></pre>
        </td>
        <td><br><br>Метод <code><span class="text-red">fill</span></code> заполняет переданный массив <code><span class="text-orange">array</span></code> переданным значением <code><span class="text-green">value</span></code>.</td>
    </tr>
    </tbody>
</table>
<p>При вызове метода <code><span class="text-red">fill</span></code> переменной <code><span class="text-orange">array</span></code> присваивается ссылка на массив <code><span class="text-user">data</span></code>. Переменной <code><span class="text-green">value</span></code> присваивается ссылка на объект-строку «Hello».</p>
<p>Вот как будет выглядеть ситуация в памяти <strong>перед вызовом метода</strong> <code><span class="text-red">fill</span></code>:</p>
<p><img data-id="4aef1754-a20b-4c89-99e1-bda2024c48d7" src="https://cdn.javarush.com/images/article/4aef1754-a20b-4c89-99e1-bda2024c48d7/original.png" alt="Передача ссылок в методы"></p>
<p><span>Вот как будет выглядеть ситуация <strong>во время работы метода</strong> <code><span class="text-red">fill</span></code></span><span>:</span></p>
<img data-id="ae3c142c-5abb-42e8-9d3d-72985d3e7bb9" src="https://cdn.javarush.com/images/article/ae3c142c-5abb-42e8-9d3d-72985d3e7bb9/original.png" alt="Передача ссылок в методы 2">
<p>Переменные <code><span class="text-user">data</span></code> и <code><span class="text-orange">array</span></code> ссылаются (хранят ссылки) на один и тот же массив-контейнер в памяти.</p>
<p>Переменная <code><span class="text-green">value</span></code> хранит ссылку объекта строки <code>Hello</code>.</p>
<p>Ячейки массива тоже хранят просто ссылки на объект <code>Hello</code>.</p>
<p>Фактически никакого дублирования объектов не происходит — копируются только ссылки.</p>
<hr>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task07.task0710"></div>
<div class="task-widget-container" showCover="true" taskKey="com.javarush.task.pro.task07.task0711"></div>
<hr>
<h2>6. Сравнение с языком С/С++</h2>
<p>Иногда Java-программистов спрашивают на собеседовании: как передаются данные в методы в Java? Иногда еще уточняют: по ссылке или по значению?</p>
<p>Этот вопрос идет из языка С++ — <span class="text-orange">в языке Java он не имеет смысла</span>. В Java переменным-параметрам всегда просто присваиваются значения переменных-аргументов. Так что правильным ответом будет — <span class="text-red">по значению</span>.</p>
<p>Но будьте готовы к тому, чтобы <strong>объяснить свою позицию</strong>, т.к. вам могут тут же возразить, что «примитивные типы передаются по значению, а ссылочные &#8211; по ссылке».</p>
<p>Истоки этой проблемы связаны с тем, что многие Java-программисты были в прошлом С++ программистами. А там вопрос «как передаются параметры в методы» играл очень важную роль.</p>
<p>В Java все однозначно: примитивные типы хранят значения, ссылочные тоже хранят значение — ссылку. Все дело в том, что считать <strong>значением</strong> переменной.</p>
<p>В языке C++ в переменной можно было хранить как ссылку на объект, так и сам объект. То же касалось примитивных типов: в переменной можно было хранить значение или объявить переменную ссылкой на тип <code>int</code>. Поэтому чтобы не путаться, С++ программисты <span class="term">ссылку на объект</span> всегда называют <span class="term">ссылкой</span>, а сам объект — значением.</p>
<p>В С++ легко могла сложиться ситуация, что одна переменная содержит объект, а другая — ссылку на этот же объект. Поэтому вопрос, что хранит в себе переменная — сам объект или только ссылку на него — был очень важен. При передаче в метод объекта он копировался (если передавался по значению), и не копировался (если передавался по ссылке).</p>
<p>В Java этой двойственности нет, и правильный ответ звучит так: <strong>параметры в методы Java передаются по значению</strong>. Просто в случае с ссылочными переменными это значение — ссылка.</p>
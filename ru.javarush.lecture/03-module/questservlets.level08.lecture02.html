Подсети
<p>----------------------------------------</p>
Знакомство с хостами и подсетями
Маски подсетей
DHCP
localhost и 127.0.0.1
<p>----------------------------------------</p>
<h2>3.1 Знакомство с хостами и подсетями</h2>
<p><strong>IP-адреса </strong>используются для идентификации устройств в сети. Для взаимодействия c другими устройствами по сети IP-адрес должен быть назначен каждому сетевому устройству (в том числе компьютерам, серверам, маршрутизаторам, принтерам). Такие устройства в сети называют <strong>хостами</strong>.</p>
<p>У сетевого оборудования тоже есть свои номера. А все компьютеры, которые обслуживает конкретное сетевое оборудование, называют <strong>подсетью</strong>. У каждой подсети есть некий шаблон, по которому сетевое оборудование назначает IP-адреса своим подшефным. Такой шаблон называется <strong>маской подсети</strong>.</p>
<p>Маски подсетей позволяют разделять одну сеть на несколько подсетей, а также задают максимальное количество подшефных хостов.</p>
<h3>Знакомство с IP-адресами</h3>
<p>IP-адрес состоит из четырех частей, записанных в виде десятичных чисел с точками (например, <code>192.168.1.1</code>). Каждую из этих четырех частей называют <strong>октетом</strong>. Октет представляет собой восемь двоичных цифр, например <code>00001111</code>.</p>
<p>Tаким образом, каждый октет может принимать в двоичном виде значения от <code>00000000</code> до <code>11111111</code> или от <code>0</code> до <code>255</code> в десятичном виде.</p>
<h3>Структура IP-адреса</h3>
<p>Первая часть IP-адреса представляет собой номер сети, другая – идентификатор хоста. Вместе они образуют уникальный IP-адрес хоста. Чем короче номер сети, тем больше в ней может поместиться хостов. Если номер сети занимает <code>3 байта</code>, то на номер хоста останется только один байт (максимум <code>255</code> хостов в сети).</p>
<p>Номер сети используется маршрутизаторами (роутерами, интернет-центрами) для передачи пакетов в нужные сети, тогда как идентификатор хоста определяет конкретное устройство в этой сети, которому должны быть доставлены пакеты.</p>
<h3>Пример номера сети и хоста</h3>
<p>На следующем рисунке показан пример IP-адреса, в котором первые три октета (<code>192.168.1</code>) представляют собой номер сети, а четвертый октет (<code>16</code>) – идентификатор хоста.</p>
<img data-max-width="512" data-id="fb836885-cafa-404c-8130-d65294f56825" src="https://cdn.javarush.com/images/article/fb836885-cafa-404c-8130-d65294f56825/512.jpeg" alt="Пример номера сети и хоста">
<p>Количество двоичных цифр в IP-адресе, которые приходятся на номер сети, и количество цифр в адресе, приходящееся на идентификатор хоста, могут быть различными в зависимости от маски подсети.</p>
<h2>3.2 Маски подсетей</h2>
<h3>Частные IP-адреса</h3>
<p>У каждого хоста в интернете должен быть уникальный адрес. Исключение – это IP-адреса внутри локальных сетей.</p>
<p>Если у тебя в офисе есть своя локальная сеть, то у ее компьютеров будут свои собственные неуникальные IP-адреса. Однако, если это компьютер напрямую подключенный к интернету, или сервер, то у него должен быть публичный уникальный IP-адрес.</p>
<p>Есть специальная организация (IANA), которая занимается распределением IP-адресов. Интернет-провайдеры выкупают у нее IP-адреса блоками (подсетями) и потом продают их своим клиентам. Так что если вы платите за белый IP-адрес, то все в порядке (провайдер тоже за него платит деньги).</p>
<p>Также IANA выделила несколько подсетей, которые принято использовать для непубличных локальных сетей. Так как эти подсети непубличные, их может использовать кто угодно для любых целей. Всего таких подсетей три: большая, средняя и маленькая.</p>
<p>Для них зарезервированы следующие три блока IP-адресов:</p>
<ul>
    <li><code>10.0.0.0</code> — <code>10.255.255.255</code></li>
    <li><code>172.16.0.0</code> — <code>172.31.255.255</code></li>
    <li><code>192.168.0.0</code> — <code>192.168.255.255</code></li>
</ul>
<p>IP-адреса указанных частных подсетей иногда называют "серыми".</p>
<h3>Маски подсети</h3>
<p>Для того, чтобы определить какие биты IP-адреса относятся к номеру хоста, а какие к номеру подсети используют так называемую <strong>маску подсети</strong>.</p>
<p>Допустим у вас есть IP-адрес, записанный в двоичном виде:</p>
<div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
        <span class="text-red">11110101  01010101 1111</span><span class="text-green">1111 00000001</span>
    </code></pre>
</div>
<p>Красным цветом отмечены биты, ответственные за номер сети, зеленым – за номер хоста. Да, так тоже можно. Тут нет жесткой привязки к байтам.</p>
<p>Маской подсети будет называться такое число, где битам подсети будут соответствовать единички, а битам хоста – нули. Пример маски подсети для предыдущего адреса:</p>
<div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
        <span class="text-red">11111111  11111111 1111</span><span class="text-green">0000 00000000</span>
    </code></pre>
</div>
<p>Все биты подсети равны <code class="text-red">1</code>, все биты хоста равны <code class="text-green">0</code>.</p>
<p>Пример выделения номера сети и идентификатора хоста в IP-адресе:</p>
<table>
    <tbody>
    <tr>
        <th></th>
        <th>1-ый октет: (192)</th>
        <th>2-ой октет: (168)</th>
        <th>3-ий октет: (1)</th>
        <th>4-ый октет: (2)</th>
    </tr>
    <tr>
        <td><strong>IP-адрес (двоичный)</strong></td>
        <td>11000000</td>
        <td>10101000</td>
        <td>00000001</td>
        <td>00000010</td>
    </tr>
    <tr>
        <td><strong>Маска подсети (двоичная)</strong></td>
        <td>11111111</td>
        <td>11111111</td>
        <td>11111111</td>
        <td>00000000</td>
    </tr>
    <tr>
        <td><strong>Номер сети</strong></td>
        <td>11000000</td>
        <td>10101000</td>
        <td>00000001</td>
        <td></td>
    </tr>
    <tr>
        <td><strong>Идентификатор хоста</strong></td>
        <td></td>
        <td></td>
        <td></td>
        <td> 00000010</td>
    </tr>
    </tbody>
</table>
<p>Маски подсети всегда состоят из серии последовательных единиц, начиная с самого левого бита маски, за которой следует серия последовательных нулей, составляющих в общей сложности <code>32</code> бита.</p>
<p>Маску подсети можно определить, как количество бит в адресе, представляющих номер сети (количество бит со значением "<code>1</code>"). Например, "<code>8-битной маской</code>" называют маску, в которой <code>8</code> бит – единичные, а остальные <code>24</code> бита – нулевые.</p>
<p>Маски подсети записываются в формате десятичных чисел с точками, как и IP-адреса. В следующих примерах показаны двоичная и десятичная запись <code>8-битной</code>, <code>16-битной</code>, <code>24-битной</code> и <code>29-битной</code> масок подсети.</p>
<p>Маски подсети: </p>
<table>
    <tbody>
    <tr>
        <th></th>
        <th>Десятичная</th>
        <th>Двоичная 1-ый октет:</th>
        <th>Двоичная 2-ой октет:</th>
        <th>Двоичная 3-ий октет:</th>
        <th>Двоичная 4-ый октет:</th>
    </tr>
    <tr>
        <td><strong>8-битная маска</strong></td>
        <td>255.0.0.0</td>
        <td>11111111</td>
        <td>00000000</td>
        <td>00000000</td>
        <td>00000000</td>
    </tr>
    <tr>
        <td><strong>16-битная маска</strong></td>
        <td>255.255.0.0</td>
        <td>11111111</td>
        <td>11111111</td>
        <td>00000000</td>
        <td>00000000</td>
    </tr>
    <tr>
        <td><strong>24-битная маска</strong></td>
        <td>255.255.255.0</td>
        <td>11111111</td>
        <td>11111111</td>
        <td>11111111</td>
        <td>00000000</td>
    </tr>
    <tr>
        <td><strong>29-битная маска</strong></td>
        <td>255.255.255.248</td>
        <td>11111111</td>
        <td>11111111</td>
        <td>11111111</td>
        <td>11111000</td>
    </tr>
    </tbody>
</table>
<h2>3.3 DHCP</h2>
<p>Внутри локальной сети могут быть как статические, так и динамические IP-адреса. Системные администраторы могут присвоить статические адреса компьютерам. Динамические же назначаются компьютерам автоматически с помощью сервиса <strong>DHCP</strong>.</p>
<p><strong>Dynamic Host Configuration Protocol</strong> (DHCP) — прикладной протокол, позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры, необходимые для работы в сети TCP/IP.</p>
<p>После того, как компьютер загрузился, операционная система обращается к серверу DHCP (обычно он встроен в роутер) и получает от него для себя IP-адрес (и другие нужные параметры). Это позволяет избежать ручной настройки компьютеров сети. Такой подход используется в большинстве локальных сетей.</p>
<h3>Распределение IP-адресов</h3>
<p>Протокол DHCP предоставляет три способа распределения IP-адресов:</p>
<p><strong>Ручное распределение</strong>. При этом способе сетевой администратор сопоставляет аппаратный адрес (MAC-адрес) каждого компьютера и определенный IP-адрес. Фактически данный способ распределения адресов отличается от ручной настройки каждого компьютера лишь тем, что сведения об адресах хранятся централизованно (на сервере DHCP) и потому их проще изменять при необходимости.</p>
<p><strong>Автоматическое распределение</strong>. При данном способе каждому компьютеру на постоянное использование выделяется произвольный свободный IP-адрес из определенного администратором диапазона.</p>
<p><strong>Динамическое распределение</strong>. Этот способ аналогичен автоматическому распределению, за исключением того, что адрес выдается компьютеру не на постоянное пользование, а на определенный срок. Это называется арендой адреса. По истечении срока аренды IP-адрес вновь считается свободным и клиент обязан запросить новый (он, впрочем, может оказаться тем же самым). Кроме того, клиент сам может отказаться от полученного адреса.</p>
<p>Продвинутые службы DHCP способны автоматически обновлять записи DNS, соответствующие клиентским компьютерам, при выделении им новых адресов. Такое может быть полезно, когда у тебя большая корпоративная сеть, в которой используется внутренний DNS для имен серверов и компьютеров.</p>
<h3>Опции DHCP</h3>
<p>Помимо IP-адреса, DHCP также может сообщать клиенту дополнительные параметры, необходимые для нормальной работы в сети. Эти параметры называются опциями DHCP. Их очень много, но тебе нужно знать только несколько из них.</p>
<p>Некоторыми из наиболее часто используемых опций являются:</p>
<ul>
    <li>IP-адрес маршрутизатора по умолчанию;</li>
    <li>маска подсети;</li>
    <li>адреса серверов DNS;</li>
    <li>имя домена DNS.</li>
</ul>
<h2>3.4 localhost и 127.0.0.1</h2>
<p>Есть несколько IP-адресов, которые полезно знать. Например, IP-адрес твоего маршрутизатора. Еще один IP-адрес, который полезно знать – это <code>127.0.0.1.</code> Сейчас мы поговорим о нем немного подробнее.</p>
<h3>Что такое 127.0.0.1?</h3>
<p>IP-адрес <code>127.0.0.1</code> известен как адрес обратной связи, но вы можете увидеть его под именем <strong>localhost</strong>. Когда ты указываешь браузеру на <code>127.0.0.1</code>, он пытается подключиться к компьютеру, который ты используешь прямо сейчас. Это удобно, когда ты хочешь подключиться к серверу на своем компьютере.</p>
<p><code>127.0.0.1</code> является особенным среди IP-адресов. Как правило, IP-адрес является уникальным для каждого компьютера как в локальной сети, так и в интернете. Однако <code>127.0.0.1</code> всегда указывает на компьютер, который ты используешь в данный момент, несмотря ни на что.</p>
<p>Например, ты настроил сервер на рабочем компьютере и можешь подключиться к нему, вбив <code>127.0.0.1</code> в браузере на работе. Однако, когда ты придешь домой и введешь <code>127.0.0.1</code>, то вместо этого подключишься к домашнему компьютеру. Для подключения к рабочему компьютеру тебе будет нужен его публичный IP-адрес.</p>
<h3>Что такое localhost?</h3>
<p><strong>localhost</strong> – это фактически доменное имя для <code>127.0.0.1.</code> Особой разницы между <code>127.0.0.1</code> и localhost нет. Можно писать и так, и так, кому как нравится.</p>
<p>Ты можешь представить localhost, как «имя» для адреса <code>127.0.0.1</code>, также, как «www.google.com» является "именем" для IP-адреса Google. Однако, когда ты посещаешь www.google.com, он должен пройти через DNS-сервер, чтобы твой компьютер мог определить, какой IP-адрес соответствует имени.</p>
<p>Localhost не нужен DNS-сервер, потому что твой компьютер уже знает, что ты хочешь подключиться к нему. Таким образом, ты можешь использовать localhost, даже если у тебя нет подключения к интернету.</p>
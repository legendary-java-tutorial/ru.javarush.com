Зачем нужны логи в Java
<p>----------------------------------------</p>
Знакомство с логами
Неудачные логи
Знакомство с логгером log4j
<p>----------------------------------------</p>
<h2>1.1 Знакомство с логами</h2>
<p><strong>Лог</strong> – это список произошедших событий. Почти как морской журнал или дневник. Ну а, соответственно, <strong>логгер</strong> — это объект, с помощью которого можно вести логирование. В программировании принято логировать практически все. А в Java – так вообще все и даже немного больше.</p>
<img data-max-width="800" data-id="df09efd4-dece-47be-a17c-a89c3b63974e" src="https://cdn.javarush.com/images/article/df09efd4-dece-47be-a17c-a89c3b63974e/800.jpeg" alt="logger java">
<p>Дело в том, что Java-программы – это очень часто большие серверные приложения без UI, консоли и так далее. Они обрабатывают одновременно запросы тысяч пользователей и частенько при этом возникают различные ошибки. Особенно, когда разные нити начинают друг другу мешать.</p>
<p>И, фактически, единственным способом поиска редко воспроизводимых ошибок и сбоев в такой ситуации есть <strong>запись в лог/файл всего</strong>, что происходит в каждой нити.</p>
<p>Чаще всего в лог пишется информация о параметрах метода, с которыми он был вызван, все перехваченные ошибки, и еще много промежуточной информации. Чем полнее лог, тем легче восстановить последовательность событий и отследить причины возникновения сбоя или ошибки.</p>
<p>Но чем больше лог, тем сложнее с ним работать. Иногда логи достигают нескольких гигабайт в сутки. Это нормально.</p>
<h2>1.2 Неудачные логи</h2>
<p>В качестве первых логов разработчики использовали просто <strong>вывод в консоль</strong>. Это удобно делать во время дебага приложения – когда в консоль пишется вся важная информация и значения переменных. Но такой лог совершенно неприменим во время обычной работы приложения.</p>
<p>Во-первых, <span class="text-green">приложение может хотеть само что-то вывести в консоль и пользователь совсем не хочет видеть служебную информацию, предназначенную программисту.</span></p> 
<p>Во-вторых, <span class="text-red">размер буфера консоли ограничен, много туда не напишешь.</span></p> 
<p>И наконец, <span class="text-user">в-третьих, информацию об ошибках программы, которая собирается за долгое время, нужно отправить разработчикам программы. И удобнее всего писать всю эту информацию сразу в файл.</span></p> 
<p>Первую проблему разработчики быстро решили – придумали еще один поток вывода – <code>System.err</code>. Вы можете писать в него сообщения и они будут отправляться в отдельный поток, а не на стандартную консоль.</p> 
<p>И даже проблему с записью в файл удалось решить:</p> 
<pre class='language-java line-numbers'><code>
// Определяем файл в который будем писать лог
System.setErr(new PrintStream(new File("log.txt")));
// Выводим сообщения
System.err.println("Сообщение 1");
System.err.println("Сообщение 2");
// Выводим сообщение об ошибке
try {
    throw new Exception("Сообщение об ошибке");
} catch (Exception e) {
    e.printStackTrace();
}
</code></pre>
<p>Но даже в таком виде, это не решало всей проблемы, поэтому было решено создать специальную библиотеку, которая бы писала сообщения лога в файл. Она делала это по-умному и позволяла гибко настраивать фильтры логируемых событий и данных.</p> 
<p>Весь процесс логирования, по сути, состоит из трех частей:</p> 
<ul>
    <li>Первая часть – это <strong>сбор</strong> информации.</li>
    <li>Вторая часть – это <strong>фильтрование</strong> собранной информации.</li>
    <li>Третья часть – это <strong>запись</strong> отобранной информации.</li>
</ul>
<h2>1.3 Знакомство с логгером log4j</h2>
<p>Первым популярным логгером в Java-сообществе стал логгер <code>log4j</code>. Подключить его в проект очень просто, для этого нужно добавить всего пару строк в ваш pom.xml</p>
<pre class='line-numbers'><code>
&lt;dependency&gt;
    &lt;groupId&gt;log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j&lt;/artifactId&gt;
    &lt;version&gt;2.2.17&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<p>Взаимодействие твоей программы с таким логгером выглядело бы примерно так:</p> 
<pre class='language-java line-numbers'><code>
class Manager {
<span class="text-green">   private static final Logger logger = LoggerFactory.getLogger(Manager.class);</span>

   public boolean processTask(Task task) {
 <span class="text-user">       logger.debug("processTask id = " + task.getId());</span>
        try {
            task.start();
            task.progress();
            task.complete();
            return true;
        } catch (Exception e) {
 <span class="text-red">           logger.error("Unknown error", e);</span>
            return false;
        }
    }
}
</code></pre>
<p>Тут происходит три вещи:</p> 
<p><span class="text-green">Зеленым цветом выделено создание объекта</span> <code>Logger</code>. Его объект сохраняется в статическую переменную для удобной дальнейшей работы с ним. А также в метод <code>getLogger()</code> передается информация о классе, в котором происходит сбор информации.</p> 
<p> <span class="text-user">Синим цветом выделена строка, где мы логируем информацию представляющую ценность только во время дебага</span>. Для этого используется специальный метод – <code>debug()</code></p>
<p>Ну и наконец <span class="text-red">красным цветом выделена строка, где мы сохраняем в лог возникшее исключение</span>. Исключения – это потенциальные ошибки, поэтому для записи в лог используется метод <code>error()</code>.</p> 

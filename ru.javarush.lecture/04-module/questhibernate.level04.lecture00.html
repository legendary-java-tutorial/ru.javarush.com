Типы данных в SQL
<p>----------------------------------------</p>
Знакомство с типами данных в SQL. 
Числовые типы в SQL. 
Строковые типы в SQL. 
Временные типы в SQL. 
Хранение объектов в SQL. 
<p>----------------------------------------</p>
<h2>Знакомство с типами данных в SQL</h2>
 
<p>В отличии от языка JavaScript, в языке SQL есть строгая типизация. В каждой таблице у каждой колонки есть свой собственный жестко фиксированный тип данных. </p>
 
<p>Типов данных очень много, но в отличие от языка Java, тут их так много не потому, что есть типы данных на все случаи жизни. Базы Данных очень зависят от размера данных, поэтому многие типы данных отличаются друг от друга только длиной.</p>
 
<p>Всего типы данных можно разбить на 5 групп: </p>

<ul>
<li><strong>Числовые</strong> типы</li>
<li><strong>Строковые</strong> типы</li>
<li>Типы для хранения <strong>даты</strong> и <strong>времени</strong></li>
<li>Объекты: обычно представленные как <strong>набор байт</strong></li>
<li><strong>Транспортные</strong>: JSON и XML</li>
</ul>

<p>Обычно различные СУБД еще имеют свои собственные типы данных. У каждой СУБД есть своя специализация, поэтому добавление новых типов данных – очень распространенная вещь. </p>

<p>Другое дело, просто добавить новый тип данных недостаточно, нужно добавить и функции, которые будут с ним работать, а также сделать эту работу удобной и быстрой.</p> 
 
<p>Если ты будешь работать на какой-нибудь промышленной (enterprise) СУБД, то скорее всего тебе придется разбираться с ее типами данных и ее функциями. Для чего нужно будет прочитать 2-5 хороших книжек.</p>
  
<p>Мы же в рамках знакомства с SQL рассмотрим три основные группы типов данных: </p>

<ul>
<li>Числа</li>
<li>Строки</li>
<li>Даты</li>
</ul>

<h2>Числовые типы в SQL </h2>

<p>В языке SQL числовые типы делятся на три группы: </p>

<ul>
<li>Целые типы</li>
<li>Числа с фиксированной запятой (фиксированное число знаков после запятой)</li>
<li>Числа с плавающей запятой</li>
</ul>

<p>Начнем с <strong>целых чисел</strong>. Их всего 5, и они могут быть описаны одной таблицей: </p>

<table>
<tbody>
<tr>
<th># </th>
<th>Имя типа  </th>
<th>Длина в байтах  </th>
<th>Аналог из Java </th>
<th>Минимальное значение  </th>
<th>Максимальное значение  </th>
</tr>
<tr>
<td>1 </td>
<td>TINYINT  </td>
<td>1  </td>
<td>byte </td>
<td>-128  </td>
<td>127  </td>
</tr>
<tr>
<td>2 </td>
<td>SMALLINT  </td>
<td>2  </td>
<td>short </td>
<td>-32,768  </td>
<td>32,767  </td>
</tr>
<tr>
<td>3 </td>
<td>MEDIUMINT  </td>
<td>3  </td>
<td> </td>
<td>-8,388,608  </td>
<td>8,388,607 </td>
</tr>
<tr> 
<td>4 </td>
<td>INT  </td>
<td>4  </td>
<td>int </td>
<td>-2,147,483,648  </td>
<td>2,147,483,647  </td>
</tr>
<tr>
<td>5 </td>
<td>BIGINT  </td>
<td>8  </td>
<td>long </td>
<td>-2<sup>63</sup>  </td>
<td>2<sup>63-1</sup>  </td>
</tr>
</tbody>
</table>

<p>Типы данных очень похожи на типы данных в Java, однако тут имеется еще один тип integer длиной три байта. Так сделано для возможности экономить на размере.</p>
 
<p>Далее идут <strong>типы с плавающей запятой</strong>, как и в Java, их всего два:  </p>

<table>
<tbody>
<tr>
<th>#</th> 
<th>Имя типа  </th>
<th>Длина в байтах  </th>
<th>Аналог из Java </th>
<th>Минимальное значение  </th>
<th>Максимальное значение  </th>
</tr>
<tr>
<td>1 </td>
<td>FLOAT </td>
<td>4  </td>
<td>float </td>
<td>-3.40E+38 </td>
<td>+1.18E+38 </td>
</tr>
<tr>
<td>2 </td>
<td>DOUBLE </td>
<td>8  </td>
<td>doble </td>
<td>-1.79E+308 </td>
<td>+1.79E+308 </td>
</tr>
</tbody>
</table>
 
<p>Опять-таки ничего нового. Все, как и в языке Java. Однако, в отличие от Java, в SQL есть еще один специальный тип – вещественной число с фиксированной запятой. Называется оно DECIMAL.</p>
  
<p>Обычно этот тип используется для хранения сумм денег. Когда пишется название этого типа, то после него обычно указывается, сколько у числа десятичных знаков до запятой и после запятой. Общий формат выглядит так: </p>
 
    <div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-red">DECIMAL</span>(<span class="text-green">всего_знаков</span>, <span class="text-user">после_запятой</span>) </code></pre>
    </div>

<p>И небольшой пример:</p>
 
    <div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-green">salary</span> <span class="text-red">DECIMAL(<span class="text-user">5</span>,<span class="text-user">2</span>)</span> </code></pre>
    </div>

<p>Так мы описали то, что колонка salary может содержать целые числа (максимум 3 знака до запятой) и дробную часть – 2 знака после запятой. </p>

<p>Максимальное количество знаков, которое поддерживает тип DECIMAL – 65. </p>

<h2>Строковые типы в SQL</h2>
 
<p>Строки в базе данных могут храниться в двух видах: </p>

<ul>
<li>Строки с фиксированной длиной</li>
<li>Строки с переменной длиной</li>
</ul>

<p>Строки с <strong>фиксированной длиной</strong> задаются типом <strong>CHAR</strong>:</p>
 
    <div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-red">CHAR</span>(<span class="text-user">длина</span>) </code></pre>
    </div>

<p>Фиксированная длина значит, что все значения данной колонки будут содержать строго фиксированное количество символов. </p>

<p>Пример строки с фиксированной длиной: </p>
 
    <div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-green">country_code</span> <span class="text-red">CHAR(<span class="text-user">2</span>)</span> </code></pre>
    </div>

<p>Строки с <strong>переменной длиной</strong> задаются типом <strong>VARCHAR</strong>:</p>
 
    <div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-red">VARCHAR</span>(<span class="text-user">макс_длина</span>) </code></pre>
    </div>

<p>Переменная длина значит, что все значения данной колонки будут содержать текст любой длины, но не больше, чем максимальная длина.  </p>

<p>Пример строки с переменной длиной:</p>
 
    <div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-green">phone</span> <span class="text-red">VARCHAR(<span class="text-user">12</span>)</span> </code></pre>
    </div>

<p>У строк с фиксированной длиной есть очень большое преимущество. Если клиент попросил SQL-сервер вернуть ему 1,000,000-ю строку из таблицы, а в таблице строки фиксированной длины, то, зная длину строки, можно легко вычислить байты, которые относятся к искомой строке.</p>
 
<p>В случае же с переменной длиной строк, так быстро найти нужную строку таблицы не получится. Вспомни скорость доступа к ArrayList и LinkedList, тут примерно похожая ситуация.</p>
 
<p>Давай сравним, как будут храниться строки разной длины в таблице, в зависимости от типа данных. </p>

<table>
<tbody>
<tr>
<th>Строка </th>
<th>CHAR(4)  </th>
<th>Байт для хранения </th>
<th></th> 
<th>VARCHAR(4)  </th>
<th>Байт для хранения </th>
</tr>
<tr>
<td>''  </td>
<td>'       '  </td>
<td>4 </td>
<td> </td>
<td>''  </td>
<td>1 </td>
</tr>
<tr>
<td>'ab'  </td>
<td>'ab    '  </td>
<td>4 </td>
<td> </td>
<td>'ab'  </td>
<td>3 </td>
</tr>
<tr>
<td>'abcd'  </td>
<td>'abcd'  </td>
<td>4 </td>
<td> </td>
<td>'abcd'  </td>
<td>5 </td>
</tr>
<tr>
<td>'abcdefgh'  </td>
<td>'abcd'  </td>
<td>4 </td>
<td> </td>
<td>'abcd'  </td>
<td>5 </td>
</tr>
</tbody>
</table>

<p><strong>Примечание.</strong> Тип VARCHAR требует на один байт больше при той же длине, так как он вынужден дополнительно хранить длину строки. </p>
 
<h2>Временные типы в SQL</h2>
 
<p>В SQL также есть специальные типы для хранения даты и времени. Всего таких типов пять: </p>

<table>
<tbody>
<tr>
<th># </th>
<th>Имя типа  </th>
<th>Аналог из Java DateTime API </th>
<th>Пример </th>
<th>Минимальное значение  </th>
<th>Максимальное значение </th>
</tr>
<tr> 
<td>1 </td>
<td>DATE  </td>
<td>LocalDate </td>
<td>‘2022-06-30’ </td>
<td>‘1000-01-01’ </td>
<td>‘9999-12-31’ </td>
</tr>
<tr> 
<td>2 </td>
<td>TIME </td>
<td>LocalTime </td>
<td>'hh:mm:ss[.fraction]' </td>
<td>'-838:59:59.000000' </td>
<td>'838:59:59.000000' </td>
</tr>
<tr> 
<td>3 </td>
<td>DATETIME </td>
<td>LocalDateTime </td>
<td></td>
<td>‘1000-01-01 00:00:00.000000’ </td>
<td>'9999-12-31 23:59:59.999999' </td>
</tr>
<tr> 
<td>4 </td>
<td>TIMESTAMP </td>
<td>Date </td>
<td> </td>
<td>'1970-01-01 00:00:01.000000' </td>
<td>'2038-01-19 03:14:07.999999' </td>
</tr>
<tr> 
<td>5 </td>
<td>YEAR </td>
<td> </td>
<td> </td>
<td>1901 </td>
<td>2155</td>
</tr>
</tbody>  
</table>

<p>Все данные в запросах записываются в виде строки – в одинарных кавычках. Формат записи идет от большего к меньшему:  </p>

<ul>
<li>Год</li>
<li>Месяц</li>
<li>День</li>
<li>Час</li>
<li>Минута</li>
<li>Секунда</li>
<li>Доли секунды</li>
</ul>

<p>Типы DATE, TIME и DATETIME можно условно считать аналогами типов из Java DateTme API: LocalDate, LocalTime, LocalDateTime. Логика примерно та же.</p>
 
<p>Тип TIMESTAMP хранит данные в виде миллисекунд, прошедших от начала 1970 года (стандарт операционной системы UNIX). Именно в таком виде их хранит и тип Date в языке Java.</p>
 
<p>Ну и наконец есть тип YEAR, длина которого 1 байт, и который хранит значения от 1 до 255. Поэтому доступный ему диапазон годов – это 1901-2155. Год 1900 данный тип хранить не может, так как значение 0 используется для кодирования значения NULL.</p>
 
<h2>Хранение объектов в SQL</h2>
 
<p>Для хранения объектов или текстов большой длины есть специальные типы. Особо их разбирать не будем, но я все же их перечислю:  </p>
 
<table>
<tbody>
<tr>
<th>#</th> 
<th>Имя типа  </th>
<th>Пояснение </th>
</tr>
<tr>
<td>1 </td>
<td>TEXT </td>
<td>Используется для хранения текстов большой длины. При сравнении и сортировки по этому полю используется только первые 100 символов. </td>
</tr>
<tr>
<td>2 </td>
<td>BLOB </td>
<td>Название расшифровывается как Byte Large Object. Хранится в виде просто набора байт. Можно использовать, чтобы, например, хранить в базе данных картинки. </td>
</tr>
<tr>
<td>3 </td>
<td>CLOB </td>
<td>Название расшифровывается как Char Large Object. Используется для хранения текстов большой длины. </td>
</tr>
<tr>
<td>4 </td>
<td>ENUM </td>
<td>Позволяет задать фиксированный набор значений и хранить в качестве значения одно из них. </td>
</tr>
<tr>
<td>5 </td>
<td>SET </td>
<td>Позволяет задать фиксированный набор значений и хранить в качестве значения любое их подмножество. Обычно хранит их как бинарную маску. </td>
</tr>
</tbody>
</table>
 
<p>Теоретически ты можешь любой Java-объект сериализовать в виде набора байт и сохранить его в базе данных в тип BLOB. Сохранить объект – не проблема. Как с ним работать дальше? </p>

<p>Допустим, таблица хранит миллион объектов в сериализованном виде – как ты будешь выполнять по ним поиск? СУБД только тогда поддерживает определенный тип данных, когда предоставляет обширный набор функций для работы с ним.</p>